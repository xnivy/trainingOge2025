from tkinter import messagebox
import openpyxl
from openpyxl.styles import Font
import pandas as pd
import matplotlib.pyplot as plt
from openpyxl import Workbook
from openpyxl.drawing.image import Image as ExcelImage
import os
from tkinter import *
import random
from tkinter import ttk
import numpy as np
import networkx as nx
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
from matplotlib.figure import Figure
from PIL import Image, ImageTk
from openpyxl.styles import Font, PatternFill



# ================== –ì–ï–ù–ï–†–ê–¢–û–†–´ –î–ê–ù–ù–´–• ==================

def generate_task1():
    if random.choice([True, False]):
        # ========== –ü–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∑–∞–¥–∞–Ω–∏—è  ==========
        while True:
            pages = random.randint(10, 50)
            lines = random.randint(30, 50)
            chars = random.randint(40, 60)
            total_bytes = pages * lines * chars * 2  # 2 –±–∞–π—Ç–∞ –Ω–∞ —Å–∏–º–≤–æ–ª
            if total_bytes % 1024 == 0:
                size = total_bytes // 1024
                break
        return {
            "type": "numerical",
            "condition": (
                f"1. –°—Ç–∞—Ç—å—è, –Ω–∞–±—Ä–∞–Ω–Ω–∞—è –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ, —Å–æ–¥–µ—Ä–∂–∏—Ç {pages} —Å—Ç—Ä–∞–Ω–∏—Ü, "
                f"–Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ {lines} —Å—Ç—Ä–æ–∫, –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ {chars} —Å–∏–º–≤–æ–ª–æ–≤. "
                "–í –æ–¥–Ω–æ–º –∏–∑ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π Unicode –∫–∞–∂–¥—ã–π —Å–∏–º–≤–æ–ª –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è 2 –±–∞–π—Ç–∞–º–∏. "
                "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –æ–±—ä–µ–º —Å—Ç–∞—Ç—å–∏ –≤ –ö–±–∞–π—Ç–∞—Ö."
            ),
            "answer": str(size)
        }
    else:
        # ========== –í—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –∑–∞–¥–∞–Ω–∏—è –≤–∞—Ä–∏–∞–Ω—Ç ==========
        # –ë–∞–∑–æ–≤—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã (40 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)
        base_items = [
            "–ø—É—Ñ", "—Å—Ç—É–ª", "–¥–∏–≤–∞–Ω", "–∫—Ä–µ—Å–ª–æ", "–∫—Ä–æ–≤–∞—Ç—å", "—Å–æ—Ñ–∞", "—Ç–∞–±—É—Ä–µ—Ç",
            "–±–∞–Ω–∫–µ—Ç–∫–∞", "–∫–∞–Ω–∞–ø–µ", "–ª–µ–∂–∞–∫", "—à–∏—Ä–º–∞", "—Ç—Ä—é–º–æ", "–∫–æ–º–æ–¥", "—Å—É–Ω–¥—É–∫",
            "–ø–∞—Ä—Ç–∞", "–ª–∞–≤–∫–∞", "–∫–∞—á–∞–ª–∫–∞", "–ø—É—Ñ–∏–∫", "–æ—Ç—Ç–æ–º–∞–Ω", "—Ä–µ–∫–ª–∞–π–Ω–µ—Ä",
            "–ø–æ–¥—Å—Ç–∞–≤–∫–∞", "–∫–∞–±–∏–Ω–∫–∞", "–∫–∞—á–∞–ª–∫–∞", "–ª–µ–∂–∞–Ω–∫–∞", "–ø–æ–¥–ª–æ–∫–æ—Ç–Ω–∏–∫",
            "–ø—É—Ñ–∞—Ä–∏–∫", "—Å–∫–∞–º–µ–π–∫–∞", "–∫–∞–±—Ä–∏–æ–ª–µ—Ç", "–∫–∞–ø–µ–ª–ª–∞", "–º–∞–Ω–µ–∫–µ–Ω", "–æ—Ä–≥–∞–Ω–∞–π–∑–µ—Ä",
            "–ø–æ–¥–≥–æ–ª–æ–≤–Ω–∏–∫", "–ø–æ–¥–Ω–æ–∂–∫–∞", "–ø–æ–¥—Å–≤–µ—á–Ω–∏–∫", "–ø–æ–¥—Å—Ç–∞–≤–∫–∞", "–ø—Ä–∏–∫—Ä–æ–≤–∞—Ç–Ω–∏–∫",
            "—Ä–∞—Å–∫–ª–∞–¥—É—Ö–∞", "—Ä–µ—Ç—Ä–æ-–∫—Ä–µ—Å–ª–æ", "—Å—É–ø–µ—Ä-–ø—É—Ñ", "—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä"
        ]
        
        # –î–ª–∏–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ (11 —Å–∏–º–≤–æ–ª–æ–≤) - 25 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
        long_items = [
            "–ø–æ–ª—É–∫—Ä–µ—Å–ª–æ", "—Ä–∞—Å–∫–ª–∞–¥—É—à–∫–∞", "—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä", "–º–Ω–æ–≥–æ—Å–µ–∫—Ü–∏—è",
            "–≥–∏–ø–µ—Ä-–ø—É—Ñ", "–º–µ–≥–∞–∫—Ä–µ—Å–ª–æ", "—É–ª—å—Ç—Ä–∞–¥–∏–≤–∞–Ω", "—Å—É–ø–µ—Ä–∫—Ä–æ–≤–∞—Ç—å",
            "–º—É–ª—å—Ç–∏—Å–æ—Ñ–∞", "–ø—Å–µ–≤–¥–æ–∫–æ–º–æ–¥", "–∫–≤–∞–∑–∏-—à–∏—Ä–º–∞", "–Ω–µ–æ–∫–æ–º–æ–¥",
            "–∏–Ω—Ç–µ—Ä–∫—Ä–µ—Å–ª–æ", "–º–µ—Ç–∞-–ª–µ–∂–∞–∫", "–∞—Ä—Ö–∏-–±–∞–Ω–∫–µ—Ç", "–ø—Ä–æ—Ç–æ-—Å–æ—Ñ–∞",
            "–∫–∏–±–µ—Ä-—Ç–∞–±—É—Ä–µ—Ç", "–Ω–∞–Ω–æ-–∫–∞–Ω–∞–ø–µ", "–≤–∏—Ä—Ç-—Ç—Ä—é–º–æ", "–≥–µ–∫—Å–∞-–ø—É—Ñ",
            "–æ—Ä—Ç–æ-–ª–µ–∂–∞–∫", "–ø–æ–ª–∏-—à–∏—Ä–º–∞", "–∫–≤–∞–Ω—Ç-—Å–æ—Ñ–∞", "—Ç–µ–ª–µ-–∫—Ä–µ—Å–ª–æ",
            "–∞–π-–¥–∏–≤–∞–Ω—á–∏–∫"
        ]
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫
        target_word = random.choice(long_items)
        selected_base = random.sample(base_items, k=random.randint(5, 9))
        all_items = selected_base + [target_word]
        random.shuffle(all_items)
        
        # –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
        all_items = list(dict.fromkeys(all_items))
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
        original_text = "–ü—Ä–µ–¥–º–µ—Ç—ã –º–µ–±–µ–ª–∏: " + ", ".join(all_items) + "."
        
        return {
            "type": "koi8",
            "condition": (
                f"1. –í –∫–æ–¥–∏—Ä–æ–≤–∫–µ –ö–û–ò-8 (8 –±–∏—Ç/—Å–∏–º–≤–æ–ª). –£—á–µ–Ω–∏—Ü–∞ –Ω–∞–ø–∏—Å–∞–ª–∞ —Ç–µ–∫—Å—Ç:\n"
                f"¬´{original_text}¬ª\n"
                "–£–¥–∞–ª–∏–ª–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞, –∞ —Ç–∞–∫–∂–µ –ª–∏—à–Ω–∏–µ –∑–∞–ø—è—Ç—É—é –∏ –ø—Ä–æ–±–µ–ª. "
                "–†–∞–∑–º–µ—Ä —É–º–µ–Ω—å—à–∏–ª—Å—è –Ω–∞ 13 –±–∞–π—Ç. –ö–∞–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ?"
            ),
            "answer": target_word
        }

def generate_task2():
    codes = {'–ê': '.-', '–£': '..-', '–ñ': '...-', '–•': '....'}
    message = ''.join(random.choices(list(codes.keys()), k=random.randint(8,12)))
    encoded = ''.join([codes[c] for c in message])
    return {
        "type": "morse",
        "condition": (
            "2. –û—Ç —Ä–∞–∑–≤–µ–¥—á–∏–∫–∞ –±—ã–ª–∞ –ø–æ–ª—É—á–µ–Ω–∞ —Å–ª–µ–¥—É—é—â–∞—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–∞–¥–∏–æ–≥—Ä–∞–º–º–∞:\n\n"
            "–ö–æ–¥ –ú–æ—Ä–∑–µ:\n"
            "–ê: .-\n–£: ..-\n–ñ: ...-\n–•: ....\n\n"
            f"–ó–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: {encoded}\n\n"
            "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—É–∫–≤ –≤ –∏—Å—Ö–æ–¥–Ω–æ–π —Ä–∞–¥–∏–æ–≥—Ä–∞–º–º–µ."
        ),
        "encoded": encoded,
        "table": codes,
        "answer": str(len(message))
    }

def generate_task3():
    a = random.randint(5,15)
    b = random.randint(16,25)
    return {
        "type": "logic",
        "condition": (
            f"3. –ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞–∏–±–æ–ª—å—à–µ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ X, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –∏—Å—Ç–∏–Ω–Ω–æ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ:\n"
            f"–ù–ï(X <= {a}) –ò –ù–ï(Y > {b})"
        ),
        "answer": str(a)
    }

def generate_task4():
    cities = ['–ê', '–ë', '–í', '–ì', '–î']
    size = len(cities)
    matrix = np.zeros((size, size), dtype=int)
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –±–∞–∑–æ–≤—ã–π –ø—É—Ç—å
    path = []
    current = 0
    for i in range(1, size):
        path.append((current, i))
        current = i
    
    # –ó–∞–ø–æ–ª–Ω—è–µ–º –±–∞–∑–æ–≤—ã–π –ø—É—Ç—å —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
    path_weights = [random.randint(1, 5) for _ in range(len(path))]
    for (i, j), weight in zip(path, path_weights):
        matrix[i][j] = matrix[j][i] = weight
    
    # –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫ –≤ –±–∞–∑–æ–≤–æ–º –ø—É—Ç–∏
    target_max = max(path_weights)
    max_edge_index = path_weights.index(target_max)
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—É—Ç–∏ —Å –±√≥–ª—å—à–∏–º–∏ —Å—É–º–º–∞—Ä–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏
    for i in range(size):
        for j in range(i+1, size):
            if matrix[i][j] == 0 and random.random() < 0.2:
                # –î–µ–ª–∞–µ–º –≤–µ—Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –ø—É—Ç–∏ –±–æ–ª—å—à–µ —Å—É–º–º—ã –±–∞–∑–æ–≤–æ–≥–æ
                alt_weight = sum(path_weights) + random.randint(1, 3)
                matrix[i][j] = matrix[j][i] = alt_weight
    
    # –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –∫—Ä–∞—Ç—á–∞–π—à–∏–π –ø—É—Ç—å –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —á–µ—Ä–µ–∑ target_max
    matrix[path[max_edge_index]] = target_max
    matrix[path[max_edge_index][1], path[max_edge_index][0]] = target_max
    
    # –û—á–∏—â–∞–µ–º –≥–ª–∞–≤–Ω—É—é –¥–∏–∞–≥–æ–Ω–∞–ª—å
    np.fill_diagonal(matrix, 0)
    
    return {
        "type": "matrix",
        "condition": (
            "4. –í —Ç–∞–±–ª–∏—Ü–µ —É–∫–∞–∑–∞–Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–Ω–æ—Å—Ç—å –¥–æ—Ä–æ–≥ –º–µ–∂–¥—É –ø—É–Ω–∫—Ç–∞–º–∏:\n\n"
            "–£–∫–∞–∂–∏—Ç–µ –¥–ª–∏–Ω—É —Å–∞–º–æ–≥–æ –¥–ª–∏–Ω–Ω–æ–≥–æ —É—á–∞—Å—Ç–∫–∞ –∫—Ä–∞—Ç—á–∞–π—à–µ–≥–æ –ø—É—Ç–∏ –æ—Ç –ø—É–Ω–∫—Ç–∞ –ê –¥–æ –ø—É–Ω–∫—Ç–∞ –î. "
            "–ü–µ—Ä–µ–º–µ—â–∞—Ç—å—Å—è –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ –¥–æ—Ä–æ–≥–∞–º, —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤ —Ç–∞–±–ª–∏—Ü–µ:"
        ),
        "matrix": matrix,
        "answer": str(target_max)
    }

def generate_task5():
    while True:
        b = random.randint(2, 8)  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω –¥–ª—è b
        start = random.randint(20, 40)
        
        # –í—ã—á–∏—Å–ª—è–µ–º –∫–æ–Ω–µ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏
        current = start
        current += 3  # 1-—è –∫–æ–º–∞–Ω–¥–∞: +3
        current += 3  # 2-—è –∫–æ–º–∞–Ω–¥–∞: +3
        current = current // b  # 3-—è –∫–æ–º–∞–Ω–¥–∞: –¥–µ–ª–µ–Ω–∏–µ (—Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ)
        current += 3  # 4-—è –∫–æ–º–∞–Ω–¥–∞: +3
        current += 3  # 5-—è –∫–æ–º–∞–Ω–¥–∞: +3
        
        # –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ end –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∏ —Ä–∞–∑—É–º–Ω—ã–π
        if 5 <= current <= 15 and (start + 6) % b == 0:
            return {
                "type": "omega",
                "condition": (
                    f"5. –£ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –û–º–µ–≥–∞ –¥–≤–µ –∫–æ–º–∞–Ω–¥—ã:\n"
                    "1. –ø—Ä–∏–±–∞–≤—å 3\n"
                    "2. —Ä–∞–∑–¥–µ–ª–∏ –Ω–∞ b\n\n"
                    f"–ü—Ä–æ–≥—Ä–∞–º–º–∞ 11211 –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —á–∏—Å–ª–æ {start} –≤ —á–∏—Å–ª–æ {current}. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ b."
                ),
                "answer": str(b)
            }
def generate_task6():
    pairs = [(9,9), (9,10), (8,5), (11,6), (-11,10), (-5,9), (-10,10), (4,5), (8,6)]
    yes_count = sum(1 for s,t in pairs if s < 9 or t < 9)
    return {
        "type": "program",
        "condition": (
            "6. –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–≤–µ–¥–µ—Ç 'YES'?\n\n"
            "–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n"
            "s –∏ t –ø—Ä–∏–Ω–∏–º–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è:\n" + 
            '\n'.join([f"({s}, {t})" for s,t in pairs]) + 
            "\n\n–ü—Ä–æ–≥—Ä–∞–º–º–∞:\n"
            "if s < 9 or t < 9:\n    print('YES')\nelse:\n    print('NO')"
        ),
        "answer": str(yes_count)
    }

def generate_task7():
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã URL —Å –∏—Ö —Ç–∏–ø–∞–º–∏
    url_parts = [
        ('http://', 'protocol'),
        ('weather.info', 'domain'),
        ('/foto/', 'path'),
        ('2019/', 'subdir'),
        ('winter.jpg', 'file')
    ]
    
    # –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —á–∞—Å—Ç–∏ URL, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ—Ä—è–¥–æ–∫ –Ω–æ–º–µ—Ä–æ–≤ 1-5
    shuffled_parts = url_parts.copy()
    random.shuffle(shuffled_parts)
    
    # –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è "–Ω–æ–º–µ—Ä ‚Üí —á–∞—Å—Ç—å"
    numbered_parts = [(i+1, part[0]) for i, part in enumerate(shuffled_parts)]
    
    # –°–æ–∑–¥–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Ç–∏–ø–æ–≤
    correct_order = ['protocol', 'domain', 'path', 'subdir', 'file']
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç
    answer_mapping = {part[1]: num for num, part in zip(range(1,6), shuffled_parts)}
    answer = ' '.join(str(answer_mapping[t]) for t in correct_order)

    return {
        "type": "url",
        "condition": (
            "7. –°–æ–±–µ—Ä–∏—Ç–µ URL –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:\n\n"
            "–î–æ—Å—Ç—É–ø–Ω—ã–µ —á–∞—Å—Ç–∏:\n" +
            '\n'.join([f"{num}) {text}" for num, text in numbered_parts]) +
            "\n\n–í –æ—Ç–≤–µ—Ç –∑–∞–ø–∏—à–∏—Ç–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–∏—Å–µ–ª —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª, "
            "—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É URL"
        ),
        "answer": answer
    }

def generate_task8():
    both = random.randint(500,1000)
    A = random.randint(2000,3000)
    B = random.randint(1000,2000)
    return {
        "type": "search",
        "condition": (
            "8. –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã:\n\n"
            f"–§—Ä–µ–≥–∞—Ç & –≠—Å–º–∏–Ω–µ—Ü = {both}\n"
            f"–§—Ä–µ–≥–∞—Ç | –≠—Å–º–∏–Ω–µ—Ü = {A}\n"
            f"–≠—Å–º–∏–Ω–µ—Ü = {B}\n\n"
            "–°–∫–æ–ª—å–∫–æ —Å—Ç—Ä–∞–Ω–∏—Ü (–≤ —Ç—ã—Å.) –±—É–¥–µ—Ç –Ω–∞–π–¥–µ–Ω–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É '–§—Ä–µ–≥–∞—Ç'?"
        ),
        "answer": str(A + both - B)
    }

def generate_task9():
    G = nx.DiGraph()
    cities = ['–ê', '–ë', '–í', '–ì', '–î', '–ï', '–ñ', '–ó', '–ò']
    
    while True:
        G.clear()
        for i in range(len(cities)):
            for j in range(i+1, len(cities)):
                if random.random() < 0.35 and cities[j] > cities[i]:
                    G.add_edge(cities[i], cities[j])
        
        try:
            paths = list(nx.all_simple_paths(G, '–ê', '–ò'))
            if len(paths) > 0:
                break
        except:
            continue

    fig = Figure(figsize=(8, 6))
    ax = fig.add_subplot(111)
    
    # –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∑–ª–æ–≤ —Å–ª–µ–≤–∞-–Ω–∞–ø—Ä–∞–≤–æ
    pos = {
        '–ê': (0, 0),
        '–ë': (1, 1), '–í': (1, -1),
        '–ì': (2, 2), '–î': (2, 0), '–ï': (2, -2),
        '–ñ': (3, 1), '–ó': (3, -1),
        '–ò': (4, 0)
    }
    
    # –†–∏—Å—É–µ–º –≥—Ä–∞—Ñ
    nx.draw(
        G, pos, ax=ax, with_labels=True,
        node_size=1200, node_color='#E8F8FF',
        edge_color='gray', width=1.5,
        arrowsize=25, font_size=12,
        connectionstyle='arc3,rad=0.1'  # –î–ª—è –∏–∑–æ–≥–Ω—É—Ç—ã—Ö —Å—Ç—Ä–µ–ª–æ–∫
    )
    
    return {
        "type": "graph",
        "condition": "9. –ù–∞ —Ä–∏—Å—É–Ω–∫–µ ‚Äî —Å—Ö–µ–º–∞ –¥–æ—Ä–æ–≥, —Å–≤—è–∑—ã–≤–∞—é—â–∏—Ö –≥–æ—Ä–æ–¥–∞ –ê, –ë, –í, –ì, –î, –ï, –ñ, –ó, –ò.\n"
            "–ü–æ –∫–∞–∂–¥–æ–π –¥–æ—Ä–æ–≥–µ –º–æ–∂–Ω–æ –¥–≤–∏–≥–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–µ–ª–∫–∏.\n"
            "–°–∫–æ–ª—å–∫–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—É—Ç–µ–π –∏–∑ –≥–æ—Ä–æ–¥–∞ –ê –≤ –≥–æ—Ä–æ–¥ –ò?", 
        "graph": fig,
        "answer": str(len(paths))
    }

def generate_task10():
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —á–∏—Å–ª–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —Å—á–∏—Å–ª–µ–Ω–∏—è
    octal_num1 = ''.join(str(random.randint(0, 7)) for _ in range(random.randint(2, 3)))
    octal_num2 = ''.join(str(random.randint(0, 7)) for _ in range(random.randint(2, 3)))
    binary_num = '1' + ''.join(str(random.randint(0, 1)) for _ in range(random.randint(3, 5)))
    
    # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –¥–µ—Å—è—Ç–∏—á–Ω—É—é —Å–∏—Å—Ç–µ–º—É
    numbers = [
        int(octal_num1, 8),
        int(octal_num2, 8),
        int(binary_num, 2)
    ]
    
    return {
        "type": "numsys",
        "condition": (
            "10. –°—Ä–µ–¥–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã—Ö –Ω–∏–∂–µ —Ç—Ä–µ—Ö —á–∏—Å–µ–ª, –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Å—á–∏—Å–ª–µ–Ω–∏—è, "
            "–Ω–∞–π–¥–∏—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏ –∑–∞–ø–∏—à–∏—Ç–µ –µ–≥–æ –≤ –æ—Ç–≤–µ—Ç–µ –≤ –¥–µ—Å—è—Ç–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —Å—á–∏—Å–ª–µ–Ω–∏—è.\n\n"
            f"{octal_num1}‚Çà (–≤–æ—Å—å–º–µ—Ä–∏—á–Ω–∞—è)\n"
            f"{octal_num2}‚Çà (–≤–æ—Å—å–º–µ—Ä–∏—á–Ω–∞—è)\n"
            f"{binary_num}‚ÇÇ (–¥–≤–æ–∏—á–Ω–∞—è)\n\n"
            "–í –æ—Ç–≤–µ—Ç–µ –∑–∞–ø–∏—à–∏—Ç–µ —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ, –æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Å—á–∏—Å–ª–µ–Ω–∏—è —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ."
        ),
        "answer": str(min(numbers))
    }
def generate_task11():
    # –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –æ–¥–Ω–æ–≥–æ –∏–∑ 5 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∑–∞–¥–∞–Ω–∏—è
    task_variant = random.choice([1, 2, 3, 4, 5])
    
    if task_variant == 1:
        return {
            "type": "search_text",
            "condition": (
                "11. –í –æ–¥–Ω–æ–º –∏–∑ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –ò.‚ÄØ–°.‚ÄØ–¢—É—Ä–≥–µ–Ω–µ–≤–∞, —Ç–µ–∫—Å—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏–≤–µ–¥–µ–Ω –≤ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–µ –¢—É—Ä–≥–µ–Ω–µ–≤ –∫–∞—Ç–∞–ª–æ–≥–∞ DEMO-12, "
                "–ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂ –ë–∞–∑–∞—Ä–æ–≤. –° –ø–æ–º–æ—â—å—é –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ "
                "–≤—ã—è—Å–Ω–∏—Ç–µ –∏–º—è –ë–∞–∑–∞—Ä–æ–≤–∞.\n\n"
                "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ, —Ä–∞—Å–ø–∞–∫–æ–≤–∞–≤ –∞—Ä—Ö–∏–≤ –Ω–∞ —Å–≤–æ–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ.\n"
                "DEMO-12.rar"
            ),
            "answer": "–ï–≤–≥–µ–Ω–∏–π"
        }
    elif task_variant == 2:
        return {
            "type": "search_text",
            "condition": (
                "11. –í –æ–¥–Ω–æ–º –∏–∑ —Å—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏–π –í.‚ÄØ–í.‚ÄØ–ú–∞—è–∫–æ–≤—Å–∫–æ–≥–æ, —Ç–µ–∫—Å—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏–≤–µ–¥–µ–Ω –≤ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–µ –ú–∞—è–∫–æ–≤—Å–∫–∏–π –∫–∞—Ç–∞–ª–æ–≥–∞ –ü–æ—ç–∑–∏—è, "
                "–∞–≤—Ç–æ—Ä —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ —Ç–æ–º, —á—Ç–æ –ø—Ä–æ—à–µ–ª ¬´—Ç—ã—Å—è—á—É –ê—Ä–∫–æ–ª—å—Å–∫–∏—Ö –º–æ—Å—Ç–æ–≤¬ª. –° –ø–æ–º–æ—â—å—é –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã "
                "–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –≤—ã—è—Å–Ω–∏—Ç–µ, –≤ –∫–∞–∫–æ–º –º–µ—Å—è—Ü–µ —ç—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ.\n\n"
                "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ, —Ä–∞—Å–ø–∞–∫–æ–≤–∞–≤ –∞—Ä—Ö–∏–≤ –Ω–∞ —Å–≤–æ–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ.\n"
                "–ü–æ—ç–∑–∏—è.rar"
            ),
            "answer": "–æ–∫—Ç—è–±—Ä—å"
        }
    elif task_variant == 3:
        return {
            "type": "search_text",
            "condition": (
                "11. –í –æ–¥–Ω–æ–º –∏–∑ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –í.‚ÄØ–í.‚ÄØ–ù–∞–±–æ–∫–æ–≤–∞, —Ç–µ–∫—Å—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏–≤–µ–¥–µ–Ω –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –ù–∞–±–æ–∫–æ–≤, "
                "–ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂ —Å —Ñ–∞–º–∏–ª–∏–µ–π –ì–∞–Ω–∏–Ω. –° –ø–æ–º–æ—â—å—é –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã "
                "–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –≤—ã—è—Å–Ω–∏—Ç–µ –∏–º—è —ç—Ç–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.\n\n"
                "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ, —Ä–∞—Å–ø–∞–∫–æ–≤–∞–≤ –∞—Ä—Ö–∏–≤ –Ω–∞ —Å–≤–æ–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ.\n"
                "–ù–∞–±–æ–∫–æ–≤.rar"
            ),
            "answer": "–ê–ª–µ–∫—Å–µ–π"
        }
    elif task_variant == 4:
        return {
            "type": "search_text",
            "condition": (
                "11. –í –æ–¥–Ω–æ–º –∏–∑ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –ú.‚ÄØ–Æ.‚ÄØ–õ–µ—Ä–º–æ–Ω—Ç–æ–≤–∞, —Ç–µ–∫—Å—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏–≤–µ–¥–µ–Ω –≤ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–µ –∫–∞—Ç–∞–ª–æ–≥–∞ –ü—Ä–æ–∑–∞, "
                "—É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –æ –ö–æ–π—à–∞—É—Ä—Å–∫–æ–π –¥–æ–ª–∏–Ω–µ. –° –ø–æ–º–æ—â—å—é –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ "
                "–æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –≥–æ—Ä–æ–¥, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –±—ã–ª —Ä–æ–¥–æ–º —Ä—É—Å—Å–∫–∏–π –∏–∑–≤–æ–∑—á–∏–∫, –ø–µ—Ä–≤—ã–º —Å–ø—É—Å—Ç–∏–≤—à–∏–π—Å—è –Ω–∞ –ø–æ–≤–æ–∑–∫–µ –ø–æ –¥–æ—Ä–æ–≥–µ –º–µ–∂–¥—É –ø—Ä–æ–ø–∞—Å—Ç—å—é –∏ —É—Ç–µ—Å–æ–º.\n\n"
                "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ, —Ä–∞—Å–ø–∞–∫–æ–≤–∞–≤ –∞—Ä—Ö–∏–≤ –Ω–∞ —Å–≤–æ–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ.\n"
                "–ü—Ä–æ–∑–∞.rar"
            ),
            "answer": "–¢–∏—Ñ–ª–∏—Å"
        }
    elif task_variant == 5:
        return {
            "type": "search_text",
            "condition": (
                "11. –í –æ–¥–Ω–æ–º –∏–∑ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –ù.‚ÄØ–í.‚ÄØ–ì–æ–≥–æ–ª—è, —Ç–µ–∫—Å—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏–≤–µ–¥–µ–Ω –≤ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–µ –∫–∞—Ç–∞–ª–æ–≥–∞ –ü—Ä–æ–∑–∞, "
                "–µ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂ —Å –¥–æ–ª–∂–Ω–æ—Å—Ç—å—é —Å–º–æ—Ç—Ä–∏—Ç–µ–ª—å —É—á–∏–ª–∏—â. –° –ø–æ–º–æ—â—å—é –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã "
                "–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∏–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –≤—ã—è—Å–Ω–∏—Ç–µ —Ñ–∞–º–∏–ª–∏—é —ç—Ç–æ–≥–æ –≥–µ—Ä–æ—è.\n\n"
                "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ, —Ä–∞—Å–ø–∞–∫–æ–≤–∞–≤ –∞—Ä—Ö–∏–≤ –Ω–∞ —Å–≤–æ–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ.\n"
                "–ü—Ä–æ–∑–∞.rar"
            ),
            "answer": "–•–ª–æ–ø–æ–≤"
        }
def generate_task12():
    variant = random.choice([1, 2, 3])
    
    if variant == 1:
        return {
            "type": "files",
            "condition": (
                "12. –°–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .doc —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∞—Ö –∫–∞—Ç–∞–ª–æ–≥–∞ Task12?\n"
                "–í –æ—Ç–≤–µ—Ç–µ —É–∫–∞–∂–∏—Ç–µ —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ.\n\n"
                "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ, —Ä–∞—Å–ø–∞–∫–æ–≤–∞–≤ –∞—Ä—Ö–∏–≤ –Ω–∞ —Å–≤–æ–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ.\n"
                "Task12.rar"
            ),
            "answer": "3"
        }
    elif variant == 2:
        return {
            "type": "files",
            "condition": (
                "12. –°–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .txt —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∞—Ö –∫–∞—Ç–∞–ª–æ–≥–∞ DEMO-12?\n"
                "–í –æ—Ç–≤–µ—Ç–µ —É–∫–∞–∂–∏—Ç–µ —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ.\n\n"
                "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ, —Ä–∞—Å–ø–∞–∫–æ–≤–∞–≤ –∞—Ä—Ö–∏–≤ –Ω–∞ —Å–≤–æ–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ.\n"
                "DEMO-12.rar"
            ),
            "answer": "33"
        }
    elif variant == 3:
        return {
            "type": "files",
            "condition": (
                "12. –°–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .docx —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∞—Ö –∫–∞—Ç–∞–ª–æ–≥–∞ DEMO-12?\n"
                "–í –æ—Ç–≤–µ—Ç–µ —É–∫–∞–∂–∏—Ç–µ —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ.\n\n"
                "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ, —Ä–∞—Å–ø–∞–∫–æ–≤–∞–≤ –∞—Ä—Ö–∏–≤ –Ω–∞ —Å–≤–æ–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ.\n"
                "DEMO-12.rar"
            ),
            "answer": "0"
        }

def generate_task13():
    variant = random.choice([1, 2, 3])
    
    if variant == 1:
        return {
            "type": "presentation",
            "condition": (
                "13. –í—ã–±–µ—Ä–∏—Ç–µ –û–î–ù–û –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –Ω–∏–∂–µ –∑–∞–¥–∞–Ω–∏–π: 13.1 –∏–ª–∏ 13.2.\n\n"
                "13.1 –ò—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –∏–ª–ª—é—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ ¬´–ú—ã—à—å –ø–æ–ª–µ–≤–∫–∞¬ª, "
                "—Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –∏–∑ —Ç—Ä–µ—Ö —Å–ª–∞–π–¥–æ–≤ –Ω–∞ —Ç–µ–º—É ¬´–ú—ã—à—å –ø–æ–ª–µ–≤–∫–∞¬ª. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:\n"
                "- –ö—Ä–∞—Ç–∫–∏–µ –∏–ª–ª—é—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ –≤–Ω–µ—à–Ω–µ–º –≤–∏–¥–µ, –∞—Ä–µ–∞–ª–µ –æ–±–∏—Ç–∞–Ω–∏—è, –æ–±—Ä–∞–∑–µ –∂–∏–∑–Ω–∏ –∏ —Ä–∞—Ü–∏–æ–Ω–µ\n"
                "- –í—Å–µ —Å–ª–∞–π–¥—ã –≤ –µ–¥–∏–Ω–æ–º —Å—Ç–∏–ª–µ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏\n"
                "- –§–æ—Ä–º–∞—Ç—ã: *.odp, *.ppt, *.pptx\n\n"
                "13.2 –°–æ–∑–¥–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ –æ–±—Ä–∞–∑—Ü—É —Å —Ç–æ—á–Ω—ã–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ–º:\n"
                "- –®—Ä–∏—Ñ—Ç 14pt, –æ—Ç—Å—Ç—É–ø –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ 1—Å–º\n"
                "- –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —à–∏—Ä–∏–Ω–µ, —Ç–∞–±–ª–∏—Ü–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É\n"
                "- –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞\n"
                "- –§–æ—Ä–º–∞—Ç—ã: *.odt, *.doc, *.docx\n\n"
                "–ú—ã—à—å –ø–æ–ª–µ–≤–∫–∞.rar\n"
            ),
            "image": "–í–∞—Ä–∏–∞–Ω—Ç131.png",
            "answer": "OK"
        }
    elif variant == 2:
        return {
            "type": "presentation",
            "condition": (
                "13. –í—ã–±–µ—Ä–∏—Ç–µ –û–î–ù–û –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –Ω–∏–∂–µ –∑–∞–¥–∞–Ω–∏–π: 13.1 –∏–ª–∏ 13.2.\n\n"
                "13.1 –ò—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –∏–ª–ª—é—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ ¬´–õ–µ—Ç—É—á–∞—è –º—ã—à—å¬ª, "
                "—Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –∏–∑ —Ç—Ä–µ—Ö —Å–ª–∞–π–¥–æ–≤ –Ω–∞ —Ç–µ–º—É ¬´–õ–µ—Ç—É—á–∞—è –º—ã—à—å¬ª. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:\n"
                "- –ö—Ä–∞—Ç–∫–∏–µ –∏–ª–ª—é—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ –≤–Ω–µ—à–Ω–µ–º –≤–∏–¥–µ, –∞—Ä–µ–∞–ª–µ –æ–±–∏—Ç–∞–Ω–∏—è, –æ–±—Ä–∞–∑–µ –∂–∏–∑–Ω–∏ –∏ —Ä–∞—Ü–∏–æ–Ω–µ\n"
                "- –í—Å–µ —Å–ª–∞–π–¥—ã –≤ –µ–¥–∏–Ω–æ–º —Å—Ç–∏–ª–µ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏\n"
                "- –§–æ—Ä–º–∞—Ç—ã: *.odp, *.ppt, *.pptx\n\n"
                "13.2 –°–æ–∑–¥–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ –æ–±—Ä–∞–∑—Ü—É —Å —Ç–æ—á–Ω—ã–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ–º:\n"
                "- –®—Ä–∏—Ñ—Ç 14pt, –æ—Ç—Å—Ç—É–ø –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ 1—Å–º\n"
                "- –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —à–∏—Ä–∏–Ω–µ, —Ç–∞–±–ª–∏—Ü–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É\n"
                "- –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞\n"
                "- –§–æ—Ä–º–∞—Ç—ã: *.odt, *.doc, *.docx\n\n"
                "–õ–µ—Ç—É—á–∞—è –º—ã—à—å.rar\n"
            ),
            "image": "–í–∞—Ä–∏–∞–Ω—Ç132.png",
            "answer": "OK"
        }
    elif variant == 3:
        return {
            "type": "presentation",
            "condition": (
                "13. –í—ã–±–µ—Ä–∏—Ç–µ –û–î–ù–û –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –Ω–∏–∂–µ –∑–∞–¥–∞–Ω–∏–π: 13.1 –∏–ª–∏ 13.2.\n\n"
                "13.1 –ò—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –∏–ª–ª—é—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ DEMO-13, "
                "—Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –Ω–∞ —Ç–µ–º—É ¬´–î–æ–º–æ–≤–∞—è –º—ã—à—å¬ª. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:\n"
                "- –°–≤–µ–¥–µ–Ω–∏—è –æ –≤–Ω–µ—à–Ω–µ–º –≤–∏–¥–µ, —Å—Ä–µ–¥–µ –æ–±–∏—Ç–∞–Ω–∏—è, –ø–∏—Ç–∞–Ω–∏–∏\n"
                "- –í—Å–µ —Å–ª–∞–π–¥—ã –≤ –µ–¥–∏–Ω–æ–º —Å—Ç–∏–ª–µ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏\n"
                "- –§–æ—Ä–º–∞—Ç—ã: *.odp, *.ppt, *.pptx\n\n"
                "13.2 –°–æ–∑–¥–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ –æ–±—Ä–∞–∑—Ü—É —Å —Ç–æ—á–Ω—ã–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ–º:\n"
                "- –®—Ä–∏—Ñ—Ç 14pt, –æ—Ç—Å—Ç—É–ø –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ 1—Å–º\n"
                "- –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö\n"
                "- –°–ª–æ–∂–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞\n"
                "- –§–æ—Ä–º–∞—Ç—ã: *.odt, *.doc, *.docx\n\n"
                "DEMO-13.rar\n"
            ),
            "image": "–í–∞—Ä–∏–∞–Ω—Ç133.png",
            "answer": "OK"
        }

def generate_task14():
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    districts = ['–°–í', '–Æ', '–í', '–°']
    subjects = ['–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞', '–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞', '–Ω–µ–º–µ—Ü–∫–∏–π —è–∑—ã–∫', 
               '–æ–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ', '—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫']
    
    data = {
        '–æ–∫—Ä—É–≥': np.random.choice(districts, 1000),
        '—Ñ–∞–º–∏–ª–∏—è': ['–£—á–µ–Ω–∏–∫ ' + str(i) for i in range(1, 1001)],
        '–ø—Ä–µ–¥–º–µ—Ç': np.random.choice(subjects, 1000),
        '–±–∞–ª–ª': np.random.randint(200, 600, 1000)
    }
    
    df = pd.DataFrame(data)
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Excel
    filename = 'task14.xlsx'
    writer = pd.ExcelWriter(filename, engine='openpyxl')
    df.to_excel(writer, index=False)
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª–µ–π
    workbook = writer.book
    worksheet = writer.sheets['Sheet1']
    
    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
    worksheet['H1'] = '–û—Ç–≤–µ—Ç—ã:'
    worksheet['H1'].font = openpyxl.styles.Font(color="FFFFFF")  # –ë–µ–ª—ã–π —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞
    worksheet['H2'] = '=COUNTIFS(A:A,"–°–í",C:C,"–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞")'
    worksheet['H2'].font = openpyxl.styles.Font(color="FFFFFF")  # –ë–µ–ª—ã–π —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞
    worksheet['H3'] = '=ROUND(AVERAGEIF(A:A,"–Æ",D:D),2)'
    worksheet['H3'].font = openpyxl.styles.Font(color="FFFFFF")  # –ë–µ–ª—ã–π —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞
    
    # –£–±–∏—Ä–∞–µ–º –∑–∞–ª–∏–≤–∫—É —è—á–µ–µ–∫
    worksheet['H1'].fill = openpyxl.styles.PatternFill(fill_type=None)  # –ù–µ—Ç –∑–∞–ª–∏–≤–∫–∏
    worksheet['H2'].fill = openpyxl.styles.PatternFill(fill_type=None)  # –ù–µ—Ç –∑–∞–ª–∏–≤–∫–∏
    worksheet['H3'].fill = openpyxl.styles.PatternFill(fill_type=None)  # –ù–µ—Ç –∑–∞–ª–∏–≤–∫–∏
    
    writer.close()
    
    # –†–∞—Å—á–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
    answer1 = df[(df['–æ–∫—Ä—É–≥'] == '–°–í') & (df['–ø—Ä–µ–¥–º–µ—Ç'] == '–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞')].shape[0]
    answer2 = round(df[df['–æ–∫—Ä—É–≥'] == '–Æ']['–±–∞–ª–ª'].mean(), 2)
    
    return {
        "type": "spreadsheet",
        "condition": (
            "14. –í —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –∑–∞–Ω–µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —É—á–µ–Ω–∏–∫–æ–≤. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –ø–µ—Ä–≤—ã–µ –ø—è—Ç—å —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã:\n\n"
            "–í —Å—Ç–æ–ª–±—Ü–µ –ê –∑–∞–ø–∏—Å–∞–Ω –æ–∫—Ä—É–≥, –≤ –∫–æ—Ç–æ—Ä–æ–º —É—á–∏—Ç—Å—è —É—á–µ–Ω–∏–∫; –≤ —Å—Ç–æ–ª–±—Ü–µ –í‚ÄØ‚ÄØ‚Äî‚ÄØ—Ñ–∞–º–∏–ª–∏—è; –≤ —Å—Ç–æ–ª–±—Ü–µ –°‚ÄØ‚ÄØ‚Äî‚ÄØ–ª—é–±–∏–º—ã–π –ø—Ä–µ–¥–º–µ—Ç; –≤ —Å—Ç–æ–ª–±—Ü–µ D‚ÄØ‚ÄØ‚Äî‚ÄØ—Ç–µ—Å—Ç–æ–≤—ã–π –±–∞–ª–ª. –í—Å–µ–≥–æ –≤ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –±—ã–ª–∏ –∑–∞–Ω–µ—Å–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –ø–æ 1000 —É—á–µ–Ω–∏–∫–∞–º.\n\n"
            "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ.\n\n"
            "1.‚ÄØ‚ÄØ–°–∫–æ–ª—å–∫–æ —É—á–µ–Ω–∏–∫–æ–≤ –≤ –°–µ–≤–µ—Ä–æ-–í–æ—Å—Ç–æ—á–Ω–æ–º –æ–∫—Ä—É–≥–µ (–°–í) –≤—ã–±—Ä–∞–ª–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ª—é–±–∏–º–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫—É? –û—Ç–≤–µ—Ç –Ω–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –∑–∞–ø–∏—à–∏—Ç–µ –≤ —è—á–µ–π–∫—É F2 —Ç–∞–±–ª–∏—Ü—ã.\n\n"
            "2.‚ÄØ‚ÄØ–ö–∞–∫–æ–≤ —Å—Ä–µ–¥–Ω–∏–π —Ç–µ—Å—Ç–æ–≤—ã–π –±–∞–ª–ª —É —É—á–µ–Ω–∏–∫–æ–≤ –Æ–∂–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞ (–Æ)? –û—Ç–≤–µ—Ç –Ω–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –∑–∞–ø–∏—à–∏—Ç–µ –≤ —è—á–µ–π–∫—É –ù3 —Ç–∞–±–ª–∏—Ü—ã —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–≤–∞ –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π.\n\n"
            "3.‚ÄØ‚ÄØ–ü–æ—Å—Ç—Ä–æ–π—Ç–µ –∫—Ä—É–≥–æ–≤—É—é –¥–∏–∞–≥—Ä–∞–º–º—É, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â—É—é —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —á–∏—Å–ª–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —Å–¥–∞—é—â–∏—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫—É, –Ω–µ–º–µ—Ü–∫–∏–π —è–∑—ã–∫ –∏ –æ–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ. –õ–µ–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É–≥–æ–ª –¥–∏–∞–≥—Ä–∞–º–º—ã —Ä–∞–∑–º–µ—Å—Ç–∏—Ç–µ –≤–±–ª–∏–∑–∏ —è—á–µ–π–∫–∏ G6.\n\n"
            f"–§–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏: {filename}"
        ),
        "file": filename,
        "answer": f"{answer1}, {answer2}"
    }
def generate_task15():
    answer = "–≤–ø—Ä–∞–≤–æ\n–∑–∞–∫—Ä–∞—Å–∏—Ç—å\n–ø–æ–∫–∞ —Å–≤–µ—Ä—Ö—É —Å–≤–æ–±–æ–¥–Ω–æ\n–≤–≤–µ—Ä—Ö\n–∑–∞–∫—Ä–∞—Å–∏—Ç—å\n–∫—Ü"
    return {
        "type": "robot",
        "condition": (
            "15. –ù–∞–ø–∏—à–∏—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –†–æ–±–æ—Ç–∞, —á—Ç–æ–±—ã –∑–∞–∫—Ä–∞—Å–∏—Ç—å –Ω—É–∂–Ω—ã–µ –∫–ª–µ—Ç–∫–∏.\n"
            "–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:\n–≤–ø—Ä–∞–≤–æ\n–∑–∞–∫—Ä–∞—Å–∏—Ç—å\n..."
        ),
        "answer": answer
    }

def generate_task16():
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    n = random.randint(5, 15)
    temps = [random.randint(-10, 20) for _ in range(n)]
    positive_temps = [t for t in temps if t > 0]
    avg = round(sum(positive_temps)/len(positive_temps), 1) if positive_temps else 0
    
    return {
        "type": "temperature",
        "condition": (
            "16. –£—á–µ–Ω–∏–∫–∏ 4 –∫–ª–∞—Å—Å–∞ –≤–µ–ª–∏ –¥–Ω–µ–≤–Ω–∏–∫–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∑–∞ –ø–æ–≥–æ–¥–æ–π –∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞–ª–∏ –¥–Ω–µ–≤–Ω—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É.\n\n"
            "–¢—Ä–µ–±—É–µ—Ç—Å—è:\n"
            "1. –ù–∞–π—Ç–∏ —Å—Ä–µ–¥–Ω—é—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –¥–Ω–µ–π —Å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π > 0¬∞C\n"
            "2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–∫–∏—Ö –¥–Ω–µ–π\n\n"
            "–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π N (1 ‚â§ N ‚â§ 31), –∑–∞—Ç–µ–º N —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª - —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã.\n"
            "–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –¥–µ–Ω—å –∏–º–µ–µ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –≤—ã—à–µ 0¬∞C.\n\n"
        ),
        "input_data": [n] + temps,
        "output_data": [avg, len(positive_temps)]
    }

class Task16Window(Toplevel):
    def __init__(self, parent, task_data):
        super().__init__(parent)
        self.task_data = task_data
        self.title("–ó–∞–¥–∞–Ω–∏–µ 16 - –ê–Ω–∞–ª–∏–∑ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä")
        self.geometry("800x700")
        self.configure(bg='white')

        # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π
        self.main_canvas = Canvas(self, bg='white', highlightthickness=0)
        self.scrollbar = ttk.Scrollbar(self, orient="vertical", command=self.main_canvas.yview)
        self.scroll_frame = Frame(self.main_canvas, bg='white')

        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –∫–æ–ª–µ—Å–∏–∫–æ–º –º—ã—à–∏
        self.main_canvas.bind_all("<MouseWheel>", self.on_mouse_scroll)  # –î–æ–±–∞–≤–ª–µ–Ω–æ!
        
        self.main_canvas.configure(yscrollcommand=self.scrollbar.set)
        self.main_canvas.pack(side=LEFT, fill=BOTH, expand=True)
        self.scrollbar.pack(side=RIGHT, fill=Y)
        self.main_canvas.create_window((0, 0), window=self.scroll_frame, anchor="nw")

        # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±–ª–∞—Å—Ç–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
        self.scroll_frame.bind(
            "<Configure>",
            lambda e: self.main_canvas.configure(
                scrollregion=self.main_canvas.bbox("all")
            )
        )
        

        # –£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏
        Label(self.scroll_frame, 
             text=self.task_data['condition'],
             font=('Arial', 12),
             wraplength=700,
             justify=LEFT,
             bg='white').pack(pady=15, padx=20, anchor='w')

        # –¢–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
        self.table_frame = Frame(self.scroll_frame, bg='white')
        self.table_frame.pack(pady=10, padx=40)
        
        # –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
        headers = ["–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"]
        for col, header in enumerate(headers):
            Label(self.table_frame, text=header, 
                 font=('Arial', 12, 'bold'), 
                 borderwidth=1, relief='solid',
                 width=20, bg='#f0f0f0').grid(row=0, column=col, sticky='nsew')

        # –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        input_data = self.task_data['input_data']
        self.labels = []
        for i, val in enumerate(input_data):
            bg = '#ffffff' if i%2 == 0 else '#f8f8f8'
            lbl = Label(self.table_frame, text=str(val), 
                     borderwidth=1, relief='solid',
                     width=20, bg=bg)
            lbl.grid(row=i+1, column=0, sticky='nsew')
            self.labels.append(lbl)

        # –ö–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü—ã
        Button(self.table_frame, 
              text="üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ", 
              command=self.copy_all_data,
              bg='#5DADE2',
              fg='white').grid(row=len(input_data)+1, column=0, pady=10, sticky='ew')

        # –ë–ª–æ–∫ –æ—Ç–≤–µ—Ç–æ–≤
        answer_frame = Frame(self.scroll_frame, bg='white')
        answer_frame.pack(pady=20, padx=40)

        Label(answer_frame, text="–°—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:", 
             font=('Arial', 12), bg='white').grid(row=0, column=0)
        self.avg_entry = Entry(answer_frame, font=('Arial', 12), width=10)
        self.avg_entry.grid(row=0, column=1, padx=10)

        Label(answer_frame, text="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π:", 
             font=('Arial', 12), bg='white').grid(row=1, column=0, pady=10)
        self.count_entry = Entry(answer_frame, font=('Arial', 12), width=10)
        self.count_entry.grid(row=1, column=1, padx=10)

        Button(answer_frame, text="–ü—Ä–æ–≤–µ—Ä–∏—Ç—å", 
              command=self.check_answer,
              bg='#58D68D', fg='white').grid(row=2, columnspan=2, pady=15)

        # –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é
        self.context_menu = Menu(self, tearoff=0)
        self.context_menu.add_command(label="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å", command=self.copy_selected)
        
        # –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π
        for lbl in self.labels:
            lbl.bind("<Button-3>", self.show_context_menu)
            lbl.bind("<Button-1>", self.select_cell)

    def on_mouse_scroll(self, event):
        """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–ª–µ—Å–∏–∫–∞ –º—ã—à–∏"""
        self.main_canvas.yview_scroll(int(-1 * (event.delta / 120)), "units")

    def copy_all_data(self):
        """–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü—ã"""
        data = [str(val) for val in self.task_data['input_data']]
        self.clipboard_clear()
        self.clipboard_append('\n'.join(data))
        messagebox.showinfo("–£—Å–ø–µ—Ö", "–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!")

    def copy_selected(self):
        """–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã—Ö —è—á–µ–µ–∫"""
        try:
            selected_data = [
                lbl.cget("text") for lbl in self.labels 
                if lbl.cget("bg") == '#FFFF00'
            ]
            if not selected_data:
                raise ValueError("–ù–µ –≤—ã–±—Ä–∞–Ω—ã —è—á–µ–π–∫–∏ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è")
                
            self.clipboard_clear()
            self.clipboard_append('\n'.join(selected_data))
            messagebox.showinfo("–£—Å–ø–µ—Ö", "–í—ã–¥–µ–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã!")
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", str(e))

    def select_cell(self, event):
        """–í—ã–¥–µ–ª–µ–Ω–∏–µ —è—á–µ–π–∫–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ"""
        widget = event.widget
        if widget.cget("bg") == '#FFFF00':
            widget.config(bg='#ffffff' if self.labels.index(widget)%2 == 0 else '#f8f8f8')
        else:
            widget.config(bg='#FFFF00')

    def show_context_menu(self, event):
        """–ü–æ–∫–∞–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é"""
        self.context_menu.post(event.x_root, event.y_root)

    def check_answer(self):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞)"""
        try:
            user_avg = float(self.avg_entry.get())
            user_count = int(self.count_entry.get())
            correct_avg = self.task_data['output_data'][0]
            correct_count = self.task_data['output_data'][1]

            result = []
            if abs(user_avg - correct_avg) < 0.1:
                result.append("‚úì –°—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–µ—Ä–Ω–∞")
            else:
                result.append(f"‚úó –°—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {correct_avg}")

            if user_count == correct_count:
                result.append("‚úì –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –≤–µ—Ä–Ω–æ")
            else:
                result.append(f"‚úó –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π: {correct_count}")

            messagebox.showinfo("–†–µ–∑—É–ª—å—Ç–∞—Ç", "\n".join(result))
        
        except ValueError:
            messagebox.showerror("–û—à–∏–±–∫–∞", "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞")

    def new_example(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞"""
        self.task_data = generate_task16()
        self.destroy()
        Task16Window(self.master, self.task_data)

    def check_answer(self):
        try:
            user_avg = float(self.avg_entry.get())
            user_count = int(self.count_entry.get())
            correct_avg = self.task_data['output_data'][0]
            correct_count = self.task_data['output_data'][1]

            result = []
            if abs(user_avg - correct_avg) < 0.1:
                result.append("‚úì –°—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–µ—Ä–Ω–∞")
            else:
                result.append(f"‚úó –°—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {correct_avg}")

            if user_count == correct_count:
                result.append("‚úì –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –≤–µ—Ä–Ω–æ")
            else:
                result.append(f"‚úó –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π: {correct_count}")

            messagebox.showinfo("–†–µ–∑—É–ª—å—Ç–∞—Ç", "\n".join(result))
        
        except ValueError:
            messagebox.showerror("–û—à–∏–±–∫–∞", "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞")

    def new_example(self):
        self.task_data = generate_task16()
        self.destroy()
        Task16Window(self.master, self.task_data)

# ================== –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ 15 –∑–∞–¥–∞–Ω–∏—è ==================
class RobotTaskWindow(Toplevel):
    def __init__(self, parent):
        super().__init__(parent)
        self.title("–ó–∞–¥–∞–Ω–∏–µ 15 - –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –†–æ–±–æ—Ç–∞")
        self.geometry("1200x800")
        self.configure(bg='white')
        
        # –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π
        self.main_canvas = Canvas(self, bg='white', highlightthickness=0)
        self.scrollbar = ttk.Scrollbar(self, orient="vertical", command=self.main_canvas.yview)
        self.scrollable_frame = Frame(self.main_canvas, bg='white')

        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
        self.main_canvas.configure(yscrollcommand=self.scrollbar.set)
        self.main_canvas.pack(side=LEFT, fill=BOTH, expand=True)
        self.scrollbar.pack(side=RIGHT, fill=Y)
        self.main_canvas.create_window((0, 0), window=self.scrollable_frame, anchor="nw")

        # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
        self.scrollable_frame.bind("<Configure>", lambda e: self.main_canvas.configure(
            scrollregion=self.main_canvas.bbox("all")
        ))

        # –£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏
        condition_text = """–ò–°–ü–û–õ–ù–ò–¢–ï–õ–¨ –†–û–ë–û–¢

            –¢—Ä–µ–±—É–µ—Ç—Å—è:
            1. –ó–∞–∫—Ä–∞—Å–∏—Ç—å –≤—Å–µ –∫–ª–µ—Ç–∫–∏ –Ω–∏–∂–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π —Å—Ç–µ–Ω—ã –∏ –ª–µ–≤–µ–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π
            2. –ü—Ä–æ—Ö–æ–¥—ã –≤ —Å—Ç–µ–Ω–∞—Ö –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞—Ç—å—Å—è –Ω–µ–∑–∞–∫—Ä–∞—à–µ–Ω–Ω—ã–º–∏
            3. –†–æ–±–æ—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω —Ä–∞–∑—Ä—É—à–∏—Ç—å—Å—è

            –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
            - –≤–≤–µ—Ä—Ö/–≤–Ω–∏–∑/–≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ
            - –∑–∞–∫—Ä–∞—Å–∏—Ç—å
            - —É—Å–ª–æ–≤–∏—è: —Å–≤–µ—Ä—Ö—É/—Å–Ω–∏–∑—É/—Å–ª–µ–≤–∞/—Å–ø—Ä–∞–≤–∞ —Å–≤–æ–±–æ–¥–Ω–æ
            - —Ü–∏–∫–ª—ã: –Ω—Ü –ø–æ–∫–∞ <—É—Å–ª–æ–≤–∏–µ> ... –∫—Ü"""

        # –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å —É—Å–ª–æ–≤–∏–µ–º
        condition_frame = Frame(self.scrollable_frame, bg='white')
        Label(condition_frame, 
            text=condition_text,
            font=('Arial', 12), 
            justify=LEFT,
            bg='white',
            wraplength=1100
        ).pack(pady=15, padx=20, anchor='w')
        condition_frame.pack(fill=X)

        # –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å —Å —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º –∏ –ª–∞–±–∏—Ä–∏–Ω—Ç–æ–º
        content_frame = Frame(self.scrollable_frame, bg='white')
        
        # –•–æ–ª—Å—Ç –¥–ª—è –ª–∞–±–∏—Ä–∏–Ω—Ç–∞
        self.grid_size = 25
        self.cell_size = 30
        self.canvas = Canvas(content_frame,
            width=self.grid_size*self.cell_size,
            height=self.grid_size*self.cell_size,
            bg='white',
            highlightthickness=0
        )
        self.canvas.pack(side=LEFT, padx=20, pady=10)

        # –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        control_frame = Frame(content_frame, bg='white')
        
        # –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞ —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π
        editor_frame = Frame(control_frame, bg='white')
        self.code_editor = Text(editor_frame,
            width=55,
            height=20,
            font=('Courier New', 12),
            wrap=WORD
        )
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è/–≤—Å—Ç–∞–≤–∫–∏
        self.code_editor.bind("<Control-c>", lambda e: self.copy_text())
        self.code_editor.bind("<Control-v>", lambda e: self.paste_text())
        
        # –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è/–≤—Å—Ç–∞–≤–∫–∏
        self.context_menu = Menu(self.code_editor, tearoff=0)
        self.context_menu.add_command(label="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å", command=self.copy_text)
        self.context_menu.add_command(label="–í—Å—Ç–∞–≤–∏—Ç—å", command=self.paste_text)
        self.code_editor.bind("<Button-3>", self.show_context_menu)
        
        scroll_editor = ttk.Scrollbar(editor_frame, command=self.code_editor.yview)
        self.code_editor.configure(yscrollcommand=scroll_editor.set)
        
        self.code_editor.pack(side=LEFT, fill=BOTH, expand=True)
        scroll_editor.pack(side=RIGHT, fill=Y)
        editor_frame.pack(fill=BOTH, expand=True)

        # –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        btn_frame = Frame(control_frame, bg='white')
        Button(btn_frame,
            text="‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É",
            command=self.execute_code,
            bg='#58D68D',
            fg='white',
            font=('Arial', 12)
        ).pack(pady=10, fill=X)

        Button(btn_frame,
            text="‚ü≥ –°–±—Ä–æ—Å–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ",
            command=self.reset_maze,
            bg='#EC7063',
            fg='white',
            font=('Arial', 12)
        ).pack(pady=10, fill=X)

        Button(btn_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º",
            command=lambda: self.code_editor.delete("1.0", END),
            bg='#F4D03F',
            fg='black',
            font=('Arial', 12)
        ).pack(pady=10, fill=X)

        btn_frame.pack(fill=X)
        control_frame.pack(side=RIGHT, padx=20, pady=10, fill=BOTH, expand=True)
        content_frame.pack(fill=BOTH, expand=True)

        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–∞–±–∏—Ä–∏–Ω—Ç–∞
        self.generate_maze()
        self.robot_pos = (2, self.grid_size//2 + 1)
        self.robot_path = set()
        self.draw_maze()

        # –ü—Ä–∏–≤—è–∑–∫–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –∫–æ–ª–µ—Å–æ–º –º—ã—à–∏
        self.main_canvas.bind_all("<MouseWheel>", self.on_mouse_scroll)

    def copy_text(self):
        """–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞"""
        self.clipboard_clear()
        text = self.code_editor.get("sel.first", "sel.last")
        self.clipboard_append(text)

    def paste_text(self):
        """–í—Å—Ç–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞"""
        text = self.clipboard_get()
        self.code_editor.insert("insert", text)

    def show_context_menu(self, event):
        """–ü–æ–∫–∞–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é"""
        self.context_menu.post(event.x_root, event.y_root)

    def execute_code(self):
        """–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Ä–æ–±–æ—Ç–∞"""
        try:
            self.robot_path = set()
            code = self.code_editor.get("1.0", END)
            self.execute_commands(code.split('\n'))
            self.check_solution()  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É—Å–ª–æ–≤–∏–π
        except Exception as e:
            # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ä–æ–±–æ—Ç–∞
            # self.reset_maze()
            messagebox.showerror("–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è", str(e))


    def generate_maze(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç–µ–Ω —Å –ø—Ä–æ—Ö–æ–¥–∞–º–∏"""
        self.walls = {'horizontal': [], 'vertical': []}

        
        # –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Å—Ç–µ–Ω–∞
        h_y = self.grid_size//2
        h_start = 2
        h_end = self.grid_size - 5
        self.walls['horizontal'] = [(x, h_y) for x in range(h_start, h_end)]
        
        # –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Å—Ç–µ–Ω–∞
        v_x = h_end - 1
        v_start = h_y
        v_end = self.grid_size - 3
        self.walls['vertical'] = [(v_x, y) for y in range(v_start, v_end)]
        
        # –ü—Ä–æ—Ö–æ–¥—ã
        self.passages = {
            'horizontal': random.randint(h_start + 2, h_end - 3),
            'vertical': random.randint(v_start + 2, v_end - 3)
        }

    def draw_maze(self):
        """–û—Ç—Ä–∏—Å–æ–≤–∫–∞ –ª–∞–±–∏—Ä–∏–Ω—Ç–∞ –∏ —Ä–æ–±–æ—Ç–∞"""
        self.canvas.delete("all")
        
        # –†–∏—Å—É–µ–º —Å—Ç–µ–Ω—ã
        for x, y in self.walls['horizontal']:
            if x != self.passages['horizontal']:
                self.canvas.create_rectangle(
                    x*self.cell_size, y*self.cell_size,
                    (x+1)*self.cell_size, (y+1)*self.cell_size,
                    fill='#34495e', outline=''
                )
        
        for x, y in self.walls['vertical']:
            if y != self.passages['vertical']:
                self.canvas.create_rectangle(
                    x*self.cell_size, y*self.cell_size,
                    (x+1)*self.cell_size, (y+1)*self.cell_size,
                    fill='#34495e', outline=''
                )
        
        # –†–∏—Å—É–µ–º —Ä–æ–±–æ—Ç–∞
        rx, ry = self.robot_pos
        self.canvas.create_oval(
            rx*self.cell_size + 5, ry*self.cell_size + 5,
            (rx+1)*self.cell_size - 5, (ry+1)*self.cell_size - 5,
            fill='#e74c3c', tags='robot'
        )
        
        # –†–∏—Å—É–µ–º –∑–∞–∫—Ä–∞—à–µ–Ω–Ω—ã–µ –∫–ª–µ—Ç–∫–∏
        for x, y in self.robot_path:
            self.canvas.create_rectangle(
                x*self.cell_size, y*self.cell_size,
                (x+1)*self.cell_size, (y+1)*self.cell_size,
                fill='#3498db', outline=''
            )

    def execute_code(self):
        """–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Ä–æ–±–æ—Ç–∞"""
        self.robot_path = set()
        code = self.code_editor.get("1.0", END)
        self.execute_commands(code.split('\n'))
        self.check_solution()  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É—Å–ª–æ–≤–∏–π

    def execute_commands(self, lines):
        """–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä –∫–æ–º–∞–Ω–¥"""
        try:
            ptr = 0
            while ptr < len(lines):
                line = lines[ptr].strip()
                
                if not line:
                    ptr += 1
                    continue
                
                # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ü–∏–∫–ª–æ–≤
                if line.startswith('–Ω—Ü –ø–æ–∫–∞'):
                    condition = line[7:].strip()
                    loop_body = []
                    ptr += 1
                    while ptr < len(lines) and lines[ptr].strip() != '–∫—Ü':
                        loop_body.append(lines[ptr].strip())
                        ptr += 1
                    self.handle_loop(condition, loop_body)
                
                # –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ª–æ–≤–∏–π
                elif line.startswith('–µ—Å–ª–∏'):
                    condition = line[4:].strip()
                    if_body = []
                    ptr += 1
                    while ptr < len(lines) and lines[ptr].strip() != '–≤—Å–µ':
                        if_body.append(lines[ptr].strip())
                        ptr += 1
                    self.handle_condition(condition, if_body)
                
                # –û–±—ã—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
                else:
                    self.process_command(line)
                
                ptr += 1
                self.update()
                self.after(150)

        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è", str(e))

    def process_command(self, cmd):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–∏–Ω–æ—á–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã"""
        x, y = self.robot_pos
        moves = {
            '–≤–≤–µ—Ä—Ö': (0, -1),
            '–≤–Ω–∏–∑': (0, 1),
            '–≤–ª–µ–≤–æ': (-1, 0),
            '–≤–ø—Ä–∞–≤–æ': (1, 0),
            '–∑–∞–∫—Ä–∞—Å–∏—Ç—å': None
        }
        
        if cmd == '–∑–∞–∫—Ä–∞—Å–∏—Ç—å':
            self.robot_path.add((x, y))
            return
        
        if cmd in moves:
            dx, dy = moves[cmd]
            new_x = x + dx
            new_y = y + dy
            if self.is_valid_move(new_x, new_y):
                self.robot_pos = (new_x, new_y)
            else:
                raise ValueError(f"–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å: {cmd}")

    def is_valid_move(self, x, y):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–ø—É—Å—Ç–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è"""
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π —Å—Ç–µ–Ω—ã
        if (x, y) in self.walls['horizontal'] and x != self.passages['horizontal']:
            return False
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π —Å—Ç–µ–Ω—ã
        if (x, y) in self.walls['vertical'] and y != self.passages['vertical']:
            return False
        return 0 <= x < self.grid_size and 0 <= y < self.grid_size

    def check_condition(self, condition):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –æ—Ç—Ä–∏—Ü–∞–Ω–∏—è"""
        x, y = self.robot_pos
        negate = False
        cond = condition.strip()

        # –ï—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å "–Ω–µ ", —É–±–∏—Ä–∞–µ–º –µ–≥–æ –∏ –ø–æ–º–µ—á–∞–µ–º –∏–Ω–≤–µ—Ä—Å–∏—é
        if cond.startswith("–Ω–µ "):
            negate = True
            cond = cond[3:].strip()

        # –°–ª–æ–≤–∞—Ä—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
        directions = {
            '—Å–≤–µ—Ä—Ö—É —Å–≤–æ–±–æ–¥–Ω–æ': (0, -1),
            '—Å–Ω–∏–∑—É —Å–≤–æ–±–æ–¥–Ω–æ': (0, 1),
            '—Å–ª–µ–≤–∞ —Å–≤–æ–±–æ–¥–Ω–æ': (-1, 0),
            '—Å–ø—Ä–∞–≤–∞ —Å–≤–æ–±–æ–¥–Ω–æ': (1, 0)
        }

        if cond not in directions:
            raise ValueError(f"–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–µ —É—Å–ª–æ–≤–∏–µ: {condition}")

        dx, dy = directions[cond]

        result = self.is_valid_move(x + dx, y + dy)

        # –ï—Å–ª–∏ –±—ã–ª–æ –æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ, –∏–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        return not result if negate else result

    def handle_loop(self, condition, body):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ü–∏–∫–ª–æ–≤"""
        while self.check_condition(condition):
            for cmd in body:
                self.process_command(cmd)
                self.update()
                self.after(150)

    def handle_condition(self, condition, body):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ª–æ–≤–∏–π"""
        if self.check_condition(condition):
            for cmd in body:
                self.process_command(cmd)
                self.update()
                self.after(150)

    def reset_maze(self):
        """–°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è"""
        self.generate_maze()
        self.robot_pos = (2, self.grid_size//2 + 1)
        self.robot_path = set()
        self.code_editor.delete("1.0", END)  # –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è
        self.draw_maze()

    def on_mouse_scroll(self, event):
        """–ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫–æ–ª–µ—Å–æ–º –º—ã—à–∏"""
        self.main_canvas.yview_scroll(int(-1*(event.delta/120)), "units")

    def update(self):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞"""
        self.draw_maze()
        self.update_idletasks()

    def check_solution(self):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π —Å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç"""
        try:
            # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Å—Ç–µ–Ω
            h_y = self.grid_size // 2
            v_x = max(x for x, _ in self.walls['vertical'])

            # –¶–µ–ª–µ–≤—ã–µ –∫–ª–µ—Ç–∫–∏ (–∏—Å–∫–ª—é—á–∞—è –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)
            target_cells = {
                (x, h_y + 1) for x in range(v_x) 
                if (x, h_y + 1) not in {(18, 23), (0, 13), (18, 22), (1, 13), (18, 24)}
            }.union({
                (v_x - 1, y) for y in range(h_y + 1, self.grid_size)
                if (v_x - 1, y) not in {(18, 23), (0, 13), (18, 22), (1, 13), (18, 24)}
            })

            # –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–¥–æ–≤
            target_cells.discard((self.passages['horizontal'], h_y + 1))
            target_cells.discard((v_x - 1, self.passages['vertical']))

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
            missing = target_cells - self.robot_path
            
            if not missing:
                self.show_result("‚úì –í—Å–µ —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!", "green")
            else:
                print(f"–û—Å—Ç–∞–ª–æ—Å—å –∑–∞–∫—Ä–∞—Å–∏—Ç—å: {missing}")
                self.show_result("‚úó –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞", "red")

        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: {str(e)}")
            self.show_result("‚úó –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞", "red")

    def show_result(self, message, color):
        """–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É —ç–∫—Ä–∞–Ω–∞"""
        result_window = Toplevel(self)
        result_window.geometry("400x100")
        result_window.title("–†–µ–∑—É–ª—å—Ç–∞—Ç")
        result_window.configure(bg='white')
        result_window.attributes("-topmost", True)
        
        # –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–∫–Ω–∞
        screen_width = result_window.winfo_screenwidth()
        screen_height = result_window.winfo_screenheight()
        x = (screen_width // 2) - 200
        y = (screen_height // 2) - 50
        result_window.geometry(f"+{x}+{y}")
        
        Label(result_window, text=message, font=('Arial', 14), bg='white', fg=color).pack(pady=20)
        Button(result_window, text="OK", command=result_window.destroy, bg='#5DADE2', fg='white').pack()

# ================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==================

def find_max_edge(matrix):
    G = nx.DiGraph()
    cities = ['–ê','–ë','–í','–ì','–î','–ï']
    
    for i in range(len(cities)):
        for j in range(len(cities)):
            if matrix[i][j] > 0:
                G.add_edge(cities[i], cities[j], weight=matrix[i][j])
    
    try:
        path = nx.shortest_path(G, '–ê', '–ï', weight='weight')
        return max([G[u][v]['weight'] for u,v in zip(path[:-1], path[1:])])
    except:
        return np.max(matrix)

def calculate_b(start, end):
    current = start + 6  # +3 –¥–≤–∞–∂–¥—ã
    required = end - 6   # +3 –¥–≤–∞–∂–¥—ã –ø–æ—Å–ª–µ –¥–µ–ª–µ–Ω–∏—è
    if required <= 0:
        return 1  # –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 0
    return (start + 6) // required

# ================== –û–ö–ù–û –¢–ï–û–†–ò–ò ==================
class TheoryWindow(Toplevel):
    def __init__(self, parent, selected_tab=0):
        super().__init__(parent)
        self.title("–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã")
        self.geometry("1400x900")
        self.configure(bg='white')
        
        self.notebook = ttk.Notebook(self)
        self.create_tabs()
        self.notebook.pack(expand=1, fill=BOTH)
        self.notebook.select(selected_tab)
        
        Button(self, text="–ó–∞–∫—Ä—ã—Ç—å", command=self.destroy,
              font=('Arial', 12), bg='#EC7063', fg='white').pack(pady=10)

    def create_tabs(self):
        tabs = [
            ('1. –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã', self.task1_tab),
            ('2. –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ', self.task2_tab),
            ('3. –õ–æ–≥–∏–∫–∞', self.task3_tab),
            ('4. –ú–∞—Ç—Ä–∏—Ü—ã', self.task4_tab),
            ('5. –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏', self.task5_tab),
            ('6. –£—Å–ª–æ–≤–∏—è', self.task6_tab),
            ('7. URL', self.task7_tab),
            ('8. –ü–æ–∏—Å–∫', self.task8_tab),
            ('9. –ì—Ä–∞—Ñ—ã', self.task9_tab),
            ('10. –°–∏—Å—Ç–µ–º—ã —Å—á–∏—Å–ª–µ–Ω–∏—è', self.task10_tab),
            ('11. –ü–æ–∏—Å–∫ –≤ —Ç–µ–∫—Å—Ç–µ', self.task11_tab),
            ('12. –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞', self.task12_tab),
            ('13. –û—Ñ–∏—Å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã', self.task13_tab),
            ('14. –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã', self.task14_tab),
            ('15. –†–æ–±–æ—Ç', self.task15_tab),
            ('16. –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ', self.task16_tab)
        ]
        
        for name, method in tabs:
            frame = Frame(self.notebook, bg='white')
            method(frame)
            self.notebook.add(frame, text=name)

    def task1_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 1: –†–∞—Å—á–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –æ–±—ä–µ–º–∞

–£—Å–ª–æ–≤–∏–µ:
–°—Ç–∞—Ç—å—è —Å–æ–¥–µ—Ä–∂–∏—Ç N —Å—Ç—Ä–∞–Ω–∏—Ü, –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ M —Å—Ç—Ä–æ–∫, 
–≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ K —Å–∏–º–≤–æ–ª–æ–≤. –ö–∞–∂–¥—ã–π —Å–∏–º–≤–æ–ª –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è 2 –±–∞–π—Ç–∞–º–∏. 

–§–æ—Ä–º—É–ª–∞:
–û–±—ä–µ–º (–ö–ë) = (N √ó M √ó K √ó 2) / 1024

–ü—Ä–∏–º–µ—Ä —Ä–µ—à–µ–Ω–∏—è:
–î–∞–Ω–æ:
- –°—Ç—Ä–∞–Ω–∏—Ü: 50
- –°—Ç—Ä–æ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: 40 
- –°–∏–º–≤–æ–ª–æ–≤ –≤ —Å—Ç—Ä–æ–∫–µ: 60

–†–µ—à–µ–Ω–∏–µ:
1. –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤: 50 √ó 40 √ó 60 = 120000
2. –û–±—ä–µ–º –≤ –±–∞–π—Ç–∞—Ö: 120000 √ó 2 = 240000
3. –ü–µ—Ä–µ–≤–æ–¥ –≤ –ö–ë: 240000 / 1024 ‚âà 234.375

–û—Ç–≤–µ—Ç: 234 –ö–ë"""
        self.create_text_content(frame, content)

    def task2_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 2: –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

–£—Å–ª–æ–≤–∏–µ:
–î–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –∫–æ–¥–æ–≤ –ú–æ—Ä–∑–µ:
–ê: .- 
–£: ..-
–ñ: ...-
–•: ....

–ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è: .-..-....-..

–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–µ—à–µ–Ω–∏—è:
1. –†–∞–∑–¥–µ–ª–∏—Ç—å –∫–æ–¥ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –±—É–∫–≤—ã
2. –°–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∂–¥—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å —Ç–∞–±–ª–∏—Ü–µ–π
3. –ü–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤

–ü—Ä–∏–º–µ—Ä —Ä–µ—à–µ–Ω–∏—è:
–ö–æ–¥: .-..-....-..
–†–∞–∑–±–∏–µ–Ω–∏–µ:
.- ‚Üí –ê
..- ‚Üí –£
...- ‚Üí –ñ
.... ‚Üí –•
..- ‚Üí –£

–ò—Ç–æ–≥–æ: 5 —Å–∏–º–≤–æ–ª–æ–≤"""
        self.create_text_content(frame, content)

    def task3_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 3: –õ–æ–≥–∏—á–µ—Å–∫–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è

–£—Å–ª–æ–≤–∏–µ:
–ù–∞–π—Ç–∏ –Ω–∞–∏–±–æ–ª—å—à–µ–µ X, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –∏—Å—Ç–∏–Ω–Ω–æ:
¬¨(X ‚â§ A) ‚àß ¬¨(Y > B)

–ê–ª–≥–æ—Ä–∏—Ç–º:
1. ¬¨(X ‚â§ A) ‚Üí X > A
2. ¬¨(Y > B) ‚Üí Y ‚â§ B
3. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ X = A

–ü—Ä–∏–º–µ—Ä:
–î–∞–Ω–æ: ¬¨(X ‚â§ 10) ‚àß ¬¨(Y > 20)
–†–µ—à–µ–Ω–∏–µ:
X > 10 –∏ Y ‚â§ 20
–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Ü–µ–ª–æ–µ X = 10"""
        self.create_text_content(frame, content)

    def task4_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 4: –ê–Ω–∞–ª–∏–∑ –º–∞—Ç—Ä–∏—Ü

–£—Å–ª–æ–≤–∏–µ:
–î–∞–Ω–∞ –º–∞—Ç—Ä–∏—Ü–∞ 6x6 —Å –¥–ª–∏–Ω–∞–º–∏ –¥–æ—Ä–æ–≥ –º–µ–∂–¥—É –ø—É–Ω–∫—Ç–∞–º–∏.
–ù–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫ –∫—Ä–∞—Ç—á–∞–π—à–µ–≥–æ –ø—É—Ç–∏.

–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ –ø–æ –º–∞—Ç—Ä–∏—Ü–µ
2. –ù–∞–π—Ç–∏ –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—É—Ç–∏
3. –í—ã–±—Ä–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø—É—Ç—è—Ö

–ü—Ä–∏–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã:
   –ê –ë –í –ì –î –ï
–ê 0 3 0 2 0 0
–ë 0 0 5 0 4 0
–í 0 0 0 0 0 7
–ì 0 0 3 0 0 0
–î 0 0 0 0 0 2
–ï 0 0 0 0 0 0

–ö—Ä–∞—Ç—á–∞–π—à–∏–π –ø—É—Ç—å –ê-–ë-–î-–ï: 3+4+2=9
–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫: 4"""
        self.create_text_content(frame, content)

    def task5_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 5: –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –û–º–µ–≥–∞

–£—Å–ª–æ–≤–∏–µ:
–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∏–º–µ–µ—Ç –∫–æ–º–∞–Ω–¥—ã:
1. –ü—Ä–∏–±–∞–≤–∏—Ç—å 3
2. –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ b

–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π
2. –°–æ—Å—Ç–∞–≤–∏—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏–µ

–ü—Ä–∏–º–µ—Ä:
–ü—Ä–æ–≥—Ä–∞–º–º–∞ 11211 –¥–ª—è —á–∏—Å–ª–∞ 25 ‚Üí 10
–†–µ—à–µ–Ω–∏–µ:
25 +3 +3 /b +3 +3 = 10
–£—Ä–∞–≤–Ω–µ–Ω–∏–µ: (25+3+3)/b +3+3 = 10
(31)/b +6 = 10 ‚Üí b = 31/4 = 7.75 ‚Üí 7 (—Ü–µ–ª–æ–µ)"""
        self.create_text_content(frame, content)

    def task6_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 6: –£—Å–ª–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã

–£—Å–ª–æ–≤–∏–µ:
–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–≤–æ–¥–æ–≤ 'YES' –¥–ª—è –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∂–¥—É—é –ø–∞—Ä—É (s, t)
2. –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏—è s < 9 or t < 9

–ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:
(9,9) ‚Üí NO
(9,10) ‚Üí NO
(8,5) ‚Üí YES
(11,6) ‚Üí YES
(-11,10) ‚Üí YES

–û—Ç–≤–µ—Ç: 3"""
        self.create_text_content(frame, content)

    def task7_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 7: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ URL

–ü—Ä–∞–≤–∏–ª–∞:
- –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
- –î–æ–º–µ–Ω/–ø—É—Ç—å/—Ñ–∞–π–ª

–ü—Ä–∏–º–µ—Ä:
–ß–∞—Å—Ç–∏: [http://, site.com, blog, post.html]
–†–µ–∑—É–ª—å—Ç–∞—Ç: http://site.com/blog/post.html

–û—à–∏–±–∫–∏:
- –ù–µ–≤–µ—Ä–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —á–∞—Å—Ç–µ–π
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤"""
        self.create_text_content(frame, content)

    def task8_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 8: –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã

–§–æ—Ä–º—É–ª–∞:
A = (A|B) + (A&B) - B

–ü—Ä–∏–º–µ—Ä:
–î–∞–Ω–æ:
A|B = 3000
A&B = 500
B = 1500

–†–µ—à–µ–Ω–∏–µ:
A = 3000 + 500 - 1500 = 2000

–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:
–§–æ—Ä–º—É–ª–∞ –≤–∫–ª—é—á–µ–Ω–∏–π-–∏—Å–∫–ª—é—á–µ–Ω–∏–π"""
        self.create_text_content(frame, content)

    def task9_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 9: –ê–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–æ–≤

–£—Å–ª–æ–≤–∏–µ:
–ù–∞–π—Ç–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—É—Ç–µ–π –∏–∑ –ê –≤ –ò –Ω–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≥—Ä–∞—Ñ–µ

–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ö–µ–º–∞:"""
        lbl = Label(frame, text=content, font=('Arial', 14), 
                   wraplength=1300, justify=LEFT, bg='white')
        lbl.pack(pady=10)
        
        # –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥—Ä–∞—Ñ
        G = nx.DiGraph()
        edges = [('–ê','–ë'), ('–ê','–ì'), ('–ë','–í'), ('–ë','–î'),
                ('–í','–ñ'), ('–ì','–í'), ('–ì','–ï'), ('–î','–ñ'),
                ('–ï','–ó'), ('–ñ','–ò'), ('–ó','–ò')]
        G.add_edges_from(edges)
        
        fig = Figure(figsize=(8,6))
        ax = fig.add_subplot(111)
        pos = nx.spring_layout(G, seed=42)
        nx.draw(G, pos, ax=ax, with_labels=True, node_size=800,
               node_color='#E8F8FF', arrowsize=20)
        
        canvas = FigureCanvasTkAgg(fig, frame)
        canvas.draw()
        canvas.get_tk_widget().pack()
        
        solution = """
–ü—É—Ç–∏:
1. –ê ‚Üí –ë ‚Üí –í ‚Üí –ñ ‚Üí –ò
2. –ê ‚Üí –ë ‚Üí –î ‚Üí –ñ ‚Üí –ò
3. –ê ‚Üí –ì ‚Üí –í ‚Üí –ñ ‚Üí –ò
4. –ê ‚Üí –ì ‚Üí –ï ‚Üí –ó ‚Üí –ò

–í—Å–µ–≥–æ: 4 –ø—É—Ç–∏"""
        Label(frame, text=solution, font=('Arial', 14),
             bg='white').pack(pady=10)

    def task10_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 10: –°–∏—Å—Ç–µ–º—ã —Å—á–∏—Å–ª–µ–Ω–∏—è

–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤—Å–µ —á–∏—Å–ª–∞ –≤ –¥–µ—Å—è—Ç–∏—á–Ω—É—é —Å–∏—Å—Ç–µ–º—É
2. –°—Ä–∞–≤–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü—Ä–∏–º–µ—Ä:
41‚Çà = 4√ó8¬π + 1√ó8‚Å∞ = 33
77‚Çà = 7√ó8¬π + 7√ó8‚Å∞ = 63
10001‚ÇÇ = 1√ó2‚Å¥ + 0√ó2¬≥ + 0√ó2¬≤ + 0√ó2¬π + 1√ó2‚Å∞ = 17

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ: 17"""
        self.create_text_content(frame, content)

    def task11_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 11: –ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —Ç–µ–∫—Å—Ç–∞—Ö

–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –û—Ç–∫—Ä—ã—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∏–∑ –∞—Ä—Ö–∏–≤–∞
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ (Ctrl+F) –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
3. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–∫—Ä—É–≥ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è

–ü—Ä–∏–º–µ—Ä –¥–ª—è "–ï–≤–≥–µ–Ω–∏–π –ë–∞–∑–∞—Ä–æ–≤":
1. –í –∞—Ä—Ö–∏–≤–µ DEMO-12 –Ω–∞—Ö–æ–¥–∏–º —Ä–æ–º–∞–Ω "–û—Ç—Ü—ã –∏ –¥–µ—Ç–∏"
2. –ò—â–µ–º "–ë–∞–∑–∞—Ä–æ–≤" -> –Ω–∞—Ö–æ–¥–∏–º: "–ï–≤–≥–µ–Ω–∏–π –ë–∞–∑–∞—Ä–æ–≤, –Ω–∏–≥–∏–ª–∏—Å—Ç..."
3. –í —Å–æ—Å–µ–¥–Ω–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö –Ω–∞—Ö–æ–¥–∏–º –∏–º—è

–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:
- –ü–æ–∏—Å–∫ –ø–æ –Ω–µ–≤–µ—Ä–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É —Ñ–∞–π–ª–∞
- –ù–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è (–ï–≤–≥. –≤–º–µ—Å—Ç–æ –ï–≤–≥–µ–Ω–∏–π)"""
        self.create_text_content(frame, content)

    def task12_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 12: –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π

–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –ø–∞–ø–∫—É
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é:
   - –í Windows: *.doc –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–∞
   - –í Linux: find . -name "*.doc"

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:
Task12/
‚îú‚îÄ‚îÄ Sub1/
‚îÇ   ‚îú‚îÄ‚îÄ file1.doc
‚îÇ   ‚îî‚îÄ‚îÄ file2.txt
‚îî‚îÄ‚îÄ Sub2/
    ‚îî‚îÄ‚îÄ file3.doc

–û—Ç–≤–µ—Ç: 2 —Ñ–∞–π–ª–∞ .doc

–í–∞–∂–Ω–æ:
- –£—á–∏—Ç—ã–≤–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–∞–ø–∫–∏
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π (.DOC –∏ .doc)"""
        self.create_text_content(frame, content)

    def task13_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 13: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏/–¥–æ–∫—É–º–µ–Ω—Ç–∞

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏:
1. –ï–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å (—à—Ä–∏—Ñ—Ç—ã, —Ü–≤–µ—Ç–∞, —Ñ–æ–Ω)
2. –ó–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —Å–ª–∞–π–¥–µ
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–ª–∞–π–¥–æ–≤:
1. –¢–∏—Ç—É–ª—å–Ω—ã–π: –ù–∞–∑–≤–∞–Ω–∏–µ –∏ –∞–≤—Ç–æ—Ä
2. –û—Å–Ω–æ–≤–Ω–æ–π: –¢–∞–±–ª–∏—Ü–∞/–¥–∏–∞–≥—Ä–∞–º–º–∞
3. –ó–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π: –í—ã–≤–æ–¥—ã

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–æ–∫—É–º–µ–Ω—Ç—É:
- –û—Ç—Å—Ç—É–ø –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏: 1 —Å–º
- –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —à–∏—Ä–∏–Ω–µ
- –ì—Ä–∞–Ω–∏—Ü—ã —Ç–∞–±–ª–∏—Ü—ã —Ç–æ–ª—â–∏–Ω–æ–π 1 –ø—Ç"""
        self.create_text_content(frame, content)

    def task14_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 14: –ê–Ω–∞–ª–∏–∑ –≤ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö

–§—É–Ω–∫—Ü–∏–∏:
1. –°–ß–Å–¢–ï–°–õ–ò–ú–ù() - –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –ø–æ —É—Å–ª–æ–≤–∏—è–º
   –ü—Ä–∏–º–µ—Ä: =–°–ß–Å–¢–ï–°–õ–ò–ú–ù(A:A,"–°–í";C:C,"–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞")

2. –°–†–ó–ù–ê–ß–ï–°–õ–ò() - –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ –ø–æ —É—Å–ª–æ–≤–∏—é
   –ü—Ä–∏–º–µ—Ä: =–°–†–ó–ù–ê–ß–ï–°–õ–ò(A:A,"–Æ";D:D)

3. –î–∏–∞–≥—Ä–∞–º–º–∞:
- –í—ã–¥–µ–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
- –í—Å—Ç–∞–≤–∫–∞ ‚Üí –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π –¥–∞–Ω–Ω—ã—Ö"""
        self.create_text_content(frame, content)

    def task15_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 15: –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –†–æ–±–æ—Ç–∞

–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ–ª–µ:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚ñ† ‚ñ† ‚ñ† ‚ñ° ‚ñ° ‚ñ° ‚ñ° ‚îÇ
‚îÇ ‚ñ° ‚ñ° ‚ñ† ‚ñ° ‚ñ° ‚ñ° ‚ñ° ‚îÇ
‚îÇ ‚ñ° ‚ñ° ‚ñ† ‚ñ† ‚ñ† ‚ñ° ‚ñ° ‚îÇ ‚Üê –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Å—Ç–µ–Ω–∞
‚îÇ ‚ñ° ‚ñ° ‚ñ° ‚ñ° ‚îÇ ‚ñ° ‚ñ° ‚îÇ
‚îÇ ‚ñ° ‚ñ° ‚ñ° ‚ñ° ‚îÇ ‚ñ° ‚ñ° ‚îÇ ‚Üê –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Å—Ç–µ–Ω–∞
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –î–≤–∏–≥–∞—Ç—å—Å—è –≤–ø—Ä–∞–≤–æ –¥–æ —Å—Ç–µ–Ω—ã
2. –ó–∞–∫—Ä–∞—à–∏–≤–∞—Ç—å –∫–ª–µ—Ç–∫–∏ —Å–ª–µ–≤–∞ –æ—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π —Å—Ç–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ —Å–≤–µ—Ä—Ö—É

–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã:
–≤–ø—Ä–∞–≤–æ
–Ω—Ü –ø–æ–∫–∞ —Å–≤–µ—Ä—Ö—É —Å–≤–æ–±–æ–¥–Ω–æ
–∑–∞–∫—Ä–∞—Å–∏—Ç—å
–≤–≤–µ—Ä—Ö
–∫—Ü
–≤–Ω–∏–∑
–∑–∞–∫—Ä–∞—Å–∏—Ç—å"""
        self.create_text_content(frame, content)

    def task16_tab(self, frame):
        content = """
–ó–∞–¥–∞–Ω–∏–µ 16: –ê–Ω–∞–ª–∏–∑ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä

–ü—Ä–∏–º–µ—Ä –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
6
5 -2 10 0 7 -3

–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–µ—à–µ–Ω–∏—è:
1. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä
2. –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
3. –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–Ω–µ–π

–†–µ—à–µ–Ω–∏–µ –Ω–∞ Python:
n = int(input())
temps = [int(input()) for _ in range(n)]
positive = [t for t in temps if t > 0]
avg = sum(positive)/len(positive)
print(avg, len(positive))"""
        self.create_text_content(frame, content)

    def create_text_content(self, frame, text):
        lbl = Label(frame, text=text, font=('Arial', 14), 
                   wraplength=1300, justify=LEFT, bg='white')
        lbl.pack(pady=20, padx=20, anchor='w')
# ================== –û–ö–ù–û –ó–ê–î–ê–ù–ò–Ø ==================
class TaskWindow(Toplevel):
    def __init__(self, parent, task_data):
        super().__init__(parent)
        self.title(f"–ó–∞–¥–∞–Ω–∏–µ {task_data['type']}")
        self.geometry("1000x700")
        self.configure(bg='white')
        self.task_data = task_data
        self.result_label = None
        self.fade_alpha = 100
        self.fade_step = 5

        # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π
        main_frame = Frame(self, bg='white')
        main_frame.pack(fill=BOTH, expand=True)

        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
        canvas = Canvas(main_frame, bg='white', highlightthickness=0)
        scrollbar = ttk.Scrollbar(main_frame, orient="vertical", command=canvas.yview)
        self.scrollable_frame = Frame(canvas, bg='white')
        canvas.bind_all("<MouseWheel>", lambda e: canvas.yview_scroll(int(-1*(e.delta/120)), "units"))

        canvas.configure(yscrollcommand=scrollbar.set)
        canvas.pack(side=LEFT, fill=BOTH, expand=True)
        scrollbar.pack(side=RIGHT, fill=Y)
        canvas.create_window((0, 0), window=self.scrollable_frame, anchor="nw")

        # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
        self.scrollable_frame.bind("<Configure>", lambda e: canvas.configure(scrollregion=canvas.bbox("all")))

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–¥–∞–Ω–∏—è
        Label(self.scrollable_frame,
             text=f"–ó–∞–¥–∞–Ω–∏–µ {task_data['type']}",
             font=('Arial', 16, 'bold'),
             bg='white').pack(pady=15)

        # –£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏
        condition_frame = Frame(self.scrollable_frame, bg='white')
        condition_frame.pack(fill=X, padx=20, pady=10)

        for line in task_data['condition'].split('\n'):
            Label(condition_frame,
                 text=line.strip(),
                 font=('Arial', 14),
                 wraplength=900,
                 justify=LEFT,
                 bg='white').pack(anchor='w', pady=2)

        # –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        if task_data['type'] == 'matrix':
            self.show_matrix(task_data['matrix'])
        elif task_data['type'] == 'graph':
            self.show_graph(task_data['graph'])
        elif task_data['type'] == 'morse':
            self.show_morse_table(task_data['table'])
            Label(self.scrollable_frame,
                 text=f"–ö–æ–¥: {task_data['encoded']}",
                 font=('Courier', 14),
                 bg='white').pack(pady=10)
        elif task_data['type'] == 'spreadsheet':
            self.show_spreadsheet(task_data)
        
        # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        if 'image' in task_data:
            try:
                img = Image.open(task_data['image'])
                img = img.resize((400, 300), Image.Resampling.LANCZOS)
                photo = ImageTk.PhotoImage(img)
                img_label = Label(self.scrollable_frame, image=photo)
                img_label.image = photo
                img_label.pack(pady=10)
            except Exception as e:
                print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {e}")

        # –ë–ª–æ–∫ –æ—Ç–≤–µ—Ç–∞
        answer_frame = Frame(self.scrollable_frame, bg='white')
        answer_frame.pack(pady=20)

        self.entry = Entry(answer_frame,
                          font=('Arial', 14),
                          width=25,
                          justify=CENTER,
                          relief='solid',
                          borderwidth=2)
        self.entry.pack(side=LEFT, padx=10)

        Button(answer_frame,
              text="–ü—Ä–æ–≤–µ—Ä–∏—Ç—å",
              command=lambda: self.check_answer(task_data['answer']),
              font=('Arial', 12),
              bg='#58D68D',
              fg='white',
              padx=15,
              pady=5).pack(side=LEFT)

        # –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
        Button(self.scrollable_frame,
              text="–ó–∞–∫—Ä—ã—Ç—å",
              command=self.destroy,
              font=('Arial', 12),
              bg='#EC7063',
              fg='white',
              padx=20,
              pady=5).pack(pady=15)

    def show_matrix(self, matrix):
        matrix_frame = Frame(self.scrollable_frame, bg='white')
        matrix_frame.pack(pady=15)

        cities = ['–ê','–ë','–í','–ì','–î']
        table_frame = Frame(matrix_frame, bg='white')
        table_frame.pack()

        # –ó–∞–≥–æ–ª–æ–≤–∫–∏
        for j, city in enumerate(cities):
            Label(table_frame,
                text=city,
                width=7,
                relief='ridge',
                font=('Arial', 12, 'bold'),
                bg='#E0E0E0').grid(row=0, column=j+1, sticky='nsew')

        # –¢–µ–ª–æ —Ç–∞–±–ª–∏—Ü—ã
        for i in range(matrix.shape[0]):
            Label(table_frame,
                text=cities[i],
                width=7,
                relief='ridge',
                font=('Arial', 12),
                bg='#E0E0E0').grid(row=i+1, column=0, sticky='nsew')

            for j in range(matrix.shape[1]):
                bg = '#FFFFFF' if i != j else '#F0F0F0'
                # –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –º–∞—Ç—Ä–∏—Ü–µ —Ä–∞–≤–Ω–æ 0, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
                cell_value = str(matrix[i][j]) if matrix[i][j] != 0 else ""
                Label(table_frame,
                    text=cell_value,
                    width=7,
                    relief='ridge',
                    font=('Arial', 12),
                    bg=bg).grid(row=i+1, column=j+1, sticky='nsew')


    def show_graph(self, figure):
        graph_frame = Frame(self.scrollable_frame, bg='white')
        graph_frame.pack(pady=15, fill=BOTH, expand=True)

        canvas = FigureCanvasTkAgg(figure, graph_frame)
        canvas.draw()
        canvas.get_tk_widget().pack(fill=BOTH, expand=True)

    def show_morse_table(self, table):
        table_frame = Frame(self.scrollable_frame, bg='white')
        table_frame.pack(pady=15)

        for i, (char, code) in enumerate(table.items()):
            Label(table_frame,
                 text=f"{char}: {code}",
                 font=('Courier', 14),
                 relief='ridge',
                 padx=15,
                 pady=5,
                 bg='white').grid(row=i//2, column=i%2, padx=5, pady=5)

    def show_spreadsheet(self, task_data):
        file_frame = Frame(self.scrollable_frame, bg='white')
        file_frame.pack(pady=10)
        
        # –ö–Ω–æ–ø–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
        Button(file_frame, 
            text="–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª", 
            command=lambda: os.startfile(task_data['file']),
            font=('Arial', 12),
            bg='#5DADE2').pack(side=LEFT)
        
        Label(file_frame, 
            text=task_data['file'],
            font=('Arial', 12),
            bg='white').pack(side=LEFT, padx=10)
        
        # –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö 5 —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
        table_frame = Frame(self.scrollable_frame, bg='white')
        table_frame.pack(pady=15)
        
        # –ó–∞–≥–æ–ª–æ–≤–∫–∏
        headers = ['A', 'B', 'C', 'D']
        for j, header in enumerate(headers):
            Label(table_frame, 
                text=header,
                width=15,
                relief='ridge',
                font=('Arial', 12, 'bold'),
                bg='#E0E0E0').grid(row=0, column=j, sticky='nsew')
        
        # –î–∞–Ω–Ω—ã–µ
        df = pd.read_excel(task_data['file'])
        for i in range(5):
            for j, col in enumerate(headers):
                Label(table_frame, 
                    text=df.iloc[i, j],
                    width=15,
                    relief='ridge',
                    font=('Arial', 12),
                    bg='white').grid(row=i+1, column=j, sticky='nsew')

    def check_answer(self, correct):
        user_answer = self.entry.get().strip()
        is_correct = user_answer == str(correct)

        if is_correct:
            self.show_result("‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ!", "green")
        else:
            self.show_result(f"‚úó –û—à–∏–±–∫–∞! –ü—Ä–∞–≤–∏–ª—å–Ω–æ: {correct}", "red")

    def show_result(self, message, color):
        """–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É —ç–∫—Ä–∞–Ω–∞"""
        result_window = Toplevel(self)
        result_window.geometry("400x100")
        result_window.title("–†–µ–∑—É–ª—å—Ç–∞—Ç")
        result_window.configure(bg='white')
        result_window.attributes("-topmost", True)
        
        # –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–∫–Ω–∞
        screen_width = result_window.winfo_screenwidth()
        screen_height = result_window.winfo_screenheight()
        x = (screen_width // 2) - 200
        y = (screen_height // 2) - 50
        result_window.geometry(f"+{x}+{y}")
        
        Label(result_window, text=message, font=('Arial', 14), bg='white', fg=color).pack(pady=20)
        Button(result_window, text="OK", command=result_window.destroy, bg='#5DADE2', fg='white').pack()
    
    
# ================== –ì–õ–ê–í–ù–û–ï –û–ö–ù–û ==================
class OGEApp(Tk):
    def __init__(self):
        super().__init__()
        self.title("–û–ì–≠ 2025 - –¢—Ä–µ–Ω–∞–∂–µ—Ä")
        self.geometry("1000x600")
        self.configure(bg='white')
        self.tasks = self.generate_all_tasks()
        self.current_windows = []
        
        # –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
        self.main_container = Frame(self, bg='white')
        self.main_container.pack(fill=BOTH, expand=True)
        
        self.add_regenerate_button()
        self.show_main_menu()

    def add_regenerate_button(self):
        """–î–æ–±–∞–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–∞–¥–∞–Ω–∏–π"""
        self.regenerate_btn = Button(self, 
                                    text="‚ôª –ù–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è", 
                                    command=self.regenerate_tasks,
                                    font=('Arial', 12),
                                    bg='#5DADE2',
                                    fg='white',
                                    padx=10,
                                    pady=5)
        self.regenerate_btn.pack(side=BOTTOM, pady=(0, 5))

    def regenerate_tasks(self):
        """–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è"""
        if messagebox.askyesno("–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ", 
                             "–í—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è –±—É–¥—É—Ç –∑–∞–∫—Ä—ã—Ç—ã. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?"):
            # –ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –æ–∫–Ω–∞ –∑–∞–¥–∞–Ω–∏–π
            for window in self.current_windows.copy():
                if window.winfo_exists():
                    window.destroy()
            self.current_windows.clear()
            
            # –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞–Ω–∏—è
            self.tasks = self.generate_all_tasks()
            
            # –û–±–Ω–æ–≤–∏—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
            self.show_main_menu()
            messagebox.showinfo("–û–±–Ω–æ–≤–ª–µ–Ω–æ", "–í—Å–µ –∑–∞–¥–∞–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã!")

    def show_main_menu(self):
        """–ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"""
        self.clear_container()
        main_frame = Frame(self.main_container, bg='white')
        main_frame.place(relx=0.5, rely=0.5, anchor=CENTER)
        
        Label(main_frame, 
             text="–û–ì–≠ 2025 - –¢—Ä–µ–Ω–∞–∂–µ—Ä", 
             font=('Arial', 20, 'bold'), 
             bg='white').pack(pady=20)
        
        btn_frame = Frame(main_frame, bg='white')
        Button(btn_frame, 
              text="–ü—Ä–∞–∫—Ç–∏–∫–∞", 
              command=self.show_practice,
              font=('Arial', 14), 
              width=15, 
              height=2).pack(side=LEFT, padx=10)
        Button(btn_frame, 
              text="–¢–µ–æ—Ä–∏—è", 
              command=self.show_theory,
              font=('Arial', 14), 
              width=15, 
              height=2).pack(side=LEFT, padx=10)
        btn_frame.pack(pady=20)

    def show_practice(self):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å–µ—Ç–∫—É –∑–∞–¥–∞–Ω–∏–π"""
        self.clear_container()
        container = Frame(self.main_container, bg='white')
        container.pack(fill=BOTH, expand=True, padx=20, pady=20)
        
        # –°–µ—Ç–∫–∞ –∑–∞–¥–∞–Ω–∏–π 4x4
        grid_frame = Frame(container, bg='white')
        grid_frame.pack()
        
        for i in range(16):
            row = i // 4
            col = i % 4
            btn_text = f"–ó–∞–¥–∞–Ω–∏–µ {i+1}"
            
            # –û—Å–æ–±—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∑–∞–¥–∞–Ω–∏–π 15 –∏ 16
            if i == 14:
                cmd = self.open_task15
            elif i == 15:
                cmd = self.open_task16
            else:
                cmd = lambda idx=i: self.open_task(idx)
            
            btn = Button(grid_frame, 
                        text=btn_text, 
                        command=cmd,
                        font=('Arial', 12), 
                        width=15, 
                        height=2)
            btn.grid(row=row, column=col, padx=10, pady=10)
        
        # –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥
        Button(container, 
              text="–ù–∞–∑–∞–¥", 
              command=self.show_main_menu,
              font=('Arial', 12), 
              bg='#EC7063').pack(side=BOTTOM, pady=10)

    def show_theory(self):
        """–û—Ç–∫—Ä—ã—Ç—å –æ–∫–Ω–æ —Ç–µ–æ—Ä–∏–∏"""
        TheoryWindow(self)

    def open_task(self, task_index):
        """–û—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ"""
        if 0 <= task_index < len(self.tasks):
            task_window = TaskWindow(self, self.tasks[task_index])
            self.current_windows.append(task_window)
            task_window.protocol("WM_DELETE_WINDOW", 
                               lambda: self.on_task_window_close(task_window))

    def on_task_window_close(self, window):
        """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ –∑–∞–¥–∞–Ω–∏—è"""
        if window in self.current_windows:
            self.current_windows.remove(window)
        window.destroy()

    def open_task15(self):
        """–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∑–∞–¥–∞–Ω–∏—è 15"""
        task_window = RobotTaskWindow(self)
        self.current_windows.append(task_window)
        task_window.protocol("WM_DELETE_WINDOW", 
                           lambda: self.on_task_window_close(task_window))

    def open_task16(self):
        """–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∑–∞–¥–∞–Ω–∏—è 16"""
        task_data = generate_task16()
        task_window = Task16Window(self, task_data)
        self.current_windows.append(task_window)
        task_window.protocol("WM_DELETE_WINDOW", 
                           lambda: self.on_task_window_close(task_window))

    def generate_all_tasks(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Å–µ—Ö 16 –∑–∞–¥–∞–Ω–∏–π"""
        return [
            generate_task1(),
            generate_task2(),
            generate_task3(),
            generate_task4(),
            generate_task5(),
            generate_task6(),
            generate_task7(),
            generate_task8(),
            generate_task9(),
            generate_task10(),
            generate_task11(),
            generate_task12(),
            generate_task13(),
            generate_task14(),
            generate_task15(),
            generate_task16()
        ]

    def clear_container(self):
        """–û—á–∏—Å—Ç–∫–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞"""
        for widget in self.main_container.winfo_children():
            widget.destroy()

    def mainloop(self):
        """–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π mainloop —Å –æ—á–∏—Å—Ç–∫–æ–π"""
        super().mainloop()
        # –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
        for task in self.tasks:
            if 'file' in task and os.path.exists(task['file']):
                try:
                    os.remove(task['file'])
                except Exception as e:
                    print(f"–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞: {e}")

if __name__ == "__main__":
    app = OGEApp()
    app.mainloop()